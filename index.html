<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VARIABLES & RESET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:#040d16; --bg2:#061220; --surface:#071828;
  --s2:#0a1e30; --s3:#0d2540; --s4:#112d4a;
  --border:#0d3352; --border2:#1a4a6e; --border3:#255f8a;
  --accent:#00c8ff; --a2:#00ff9d; --a3:#0088bb;
  --warn:#ff9900; --danger:#ff3333; --purple:#a855f7;
  --text:#b8d8ee; --td:#4a7a9b; --tb:#ffffff;
  --glow:rgba(0,200,255,0.12); --glow2:rgba(0,200,255,0.25);
}
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:'Tajawal',sans-serif;background:var(--bg);color:var(--text);overflow:hidden}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
GLOBAL BACKGROUND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.grid-bg{position:fixed;inset:0;background-image:linear-gradient(rgba(0,200,255,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(0,200,255,0.025) 1px,transparent 1px);background-size:44px 44px;pointer-events:none;z-index:0}
.vignette{position:fixed;inset:0;background:radial-gradient(ellipse at center,transparent 40%,rgba(4,13,22,0.8) 100%);pointer-events:none;z-index:1}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LOGIN PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#loginPage{position:fixed;inset:0;z-index:500;display:flex;align-items:center;justify-content:center;background:var(â€“bg)}
#loginPage::before{content:â€™â€™;position:absolute;inset:0;background-image:linear-gradient(rgba(0,200,255,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,200,255,0.03) 1px,transparent 1px);background-size:44px 44px}

.login-wrap{position:relative;z-index:10;width:100%;max-width:440px;padding:0 20px;animation:fadeUp .6s ease}
@keyframes fadeUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:none}}

.login-logo{text-align:center;margin-bottom:36px}
.login-radar-icon{display:inline-block;margin-bottom:16px;position:relative}
.login-radar-icon svg{width:80px;height:80px}
.login-logo h1{font-size:24px;font-weight:900;color:#fff;line-height:1.2;margin-bottom:4px}
.login-logo p{font-size:11px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“accent);letter-spacing:3px}

.login-card{background:rgba(7,24,40,0.9);border:1px solid var(â€“border2);border-radius:12px;padding:36px;backdrop-filter:blur(20px);box-shadow:0 0 60px rgba(0,200,255,0.1),0 0 0 1px rgba(0,200,255,0.05) inset}

.login-section-title{font-size:12px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“accent);letter-spacing:2px;text-transform:uppercase;margin-bottom:6px}
.login-title{font-size:22px;font-weight:900;color:#fff;margin-bottom:28px}

.form-group{margin-bottom:20px;position:relative}
.form-label{display:block;font-size:12px;color:var(â€“td);margin-bottom:8px;letter-spacing:.5px}
.form-input{width:100%;background:rgba(4,13,22,0.8);border:1px solid var(â€“border);color:#fff;padding:13px 16px;border-radius:6px;font-family:â€˜Tajawalâ€™,sans-serif;font-size:15px;outline:none;transition:all .3s}
.form-input:focus{border-color:var(â€“accent);box-shadow:0 0 0 3px rgba(0,200,255,0.1);background:rgba(4,13,22,1)}
.form-input::placeholder{color:var(â€“td)}

.login-btn{width:100%;padding:14px;background:linear-gradient(135deg,var(â€“accent),var(â€“a3));color:#000;border:none;border-radius:6px;font-family:â€˜Tajawalâ€™,sans-serif;font-size:16px;font-weight:900;cursor:pointer;transition:all .2s;margin-top:8px;letter-spacing:.5px}
.login-btn:hover{box-shadow:0 0 30px rgba(0,200,255,0.5);transform:translateY(-1px)}
.login-btn:active{transform:none}

@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-6px)}80%{transform:translateX(6px)}}

.login-error{background:rgba(255,51,51,0.1);border:1px solid rgba(255,51,51,0.3);color:var(â€“danger);padding:10px 14px;border-radius:6px;font-size:13px;margin-bottom:16px;display:none}
.login-error.show{display:block}

.login-decorations{position:absolute;inset:0;overflow:hidden;pointer-events:none}
.ldot{position:absolute;border-radius:50%;background:var(â€“accent);opacity:.15;animation:ldotAnim 4s ease-in-out infinite}
@keyframes ldotAnim{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#appShell{position:fixed;inset:0;z-index:100;display:none;flex-direction:column}
#appShell.visible{display:flex}

/* TOP BAR */
.topbar{height:56px;background:rgba(4,13,22,.97);border-bottom:1px solid var(â€“border);display:flex;align-items:center;padding:0 24px;gap:16px;position:relative;z-index:200;flex-shrink:0}
.topbar-logo{display:flex;align-items:center;gap:10px;margin-left:20px}
.topbar-logo svg{width:32px;height:32px}
.topbar-logo .tl-text h1{font-size:15px;font-weight:900;color:#fff;line-height:1.1}
.topbar-logo .tl-text span{font-size:9px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“accent);letter-spacing:2px}

.ticker-wrap{flex:1;overflow:hidden;border:1px solid var(â€“border);border-radius:4px;padding:4px 12px;background:rgba(0,200,255,.03)}
.ticker{display:flex;align-items:center;gap:8px;font-family:â€˜Share Tech Monoâ€™,monospace;font-size:11px;color:rgba(0,200,255,.5);white-space:nowrap;animation:tickScroll 40s linear infinite}
@keyframes tickScroll{from{transform:translateX(-50%)}to{transform:translateX(0)}}
.ticker-dot{width:5px;height:5px;border-radius:50%;background:var(â€“a2);animation:blink 2s infinite;flex-shrink:0}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.2}}

.topbar-right{display:flex;align-items:center;gap:14px;margin-right:auto}
.topbar-stat{text-align:center;min-width:40px}
.ts-v{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:18px;font-weight:bold;line-height:1}
.ts-l{font-size:9px;color:var(â€“td);letter-spacing:1px;margin-top:1px}
.ts-crit .ts-v{color:var(â€“danger);text-shadow:0 0 8px rgba(255,51,51,.6)}
.ts-warn .ts-v{color:var(â€“warn);text-shadow:0 0 8px rgba(255,153,0,.5)}
.ts-ok .ts-v{color:var(â€“a2);text-shadow:0 0 8px rgba(0,255,157,.4)}
.ts-blue .ts-v{color:var(â€“accent);text-shadow:0 0 8px rgba(0,200,255,.4)}
.topbar-divider{width:1px;height:30px;background:var(â€“border)}
.topbar-clock{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:15px;color:var(â€“accent);letter-spacing:1px}
.topbar-user{display:flex;align-items:center;gap:8px;cursor:pointer;padding:5px 10px;border-radius:6px;border:1px solid var(â€“border);transition:all .2s;position:relative}
.topbar-user:hover{border-color:var(â€“border2);background:rgba(0,200,255,.05)}
.tu-avatar{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0}
.tu-name{font-size:13px;color:#fff;font-weight:600}
.tu-role{font-size:10px;color:var(â€“td)}
.user-dropdown{position:absolute;top:calc(100% + 8px);left:0;background:var(â€“surface);border:1px solid var(â€“border2);border-radius:8px;min-width:160px;overflow:hidden;display:none;z-index:999;box-shadow:0 8px 32px rgba(0,0,0,.4)}
.user-dropdown.open{display:block}
.ud-item{padding:10px 16px;font-size:13px;cursor:pointer;display:flex;align-items:center;gap:8px;transition:background .15s;color:var(â€“text)}
.ud-item:hover{background:var(â€“s2);color:#fff}
.ud-divider{height:1px;background:var(â€“border)}
.ud-item.danger{color:var(â€“danger)}
.ud-item.danger:hover{background:rgba(255,51,51,.1)}

/* MAIN LAYOUT */
.app-body{flex:1;display:flex;overflow:hidden}

/* SIDE NAV */
.sidenav{width:200px;background:rgba(6,18,32,.97);border-left:1px solid var(â€“border);display:flex;flex-direction:column;flex-shrink:0;overflow-y:auto;position:relative;z-index:10}
.nav-s{padding:14px 12px 4px;font-size:9px;color:var(â€“td);font-family:â€˜Share Tech Monoâ€™,monospace;letter-spacing:2px;text-transform:uppercase}
.ni{display:flex;align-items:center;gap:9px;padding:9px 14px;cursor:pointer;border-radius:5px;margin:1px 6px;font-size:13.5px;color:var(â€“td);transition:all .2s;border:1px solid transparent;position:relative}
.ni:hover{background:rgba(0,200,255,.05);color:var(â€“text);border-color:var(â€“border)}
.ni.active{background:rgba(0,200,255,.1);color:var(â€“accent);border-color:rgba(0,200,255,.25)}
.ni .ico{font-size:15px;width:18px;text-align:center;flex-shrink:0}
.ni-badge{margin-right:auto;font-size:10px;font-family:â€˜Share Tech Monoâ€™,monospace;padding:1px 6px;border-radius:8px}
.ni-badge.red{background:rgba(255,51,51,.2);color:var(â€“danger);border:1px solid rgba(255,51,51,.3)}
.ni-badge.yellow{background:rgba(255,153,0,.15);color:var(â€“warn);border:1px solid rgba(255,153,0,.25)}
.ni-badge.green{background:rgba(0,255,157,.1);color:var(â€“a2);border:1px solid rgba(0,255,157,.2)}
.nav-div{height:1px;background:var(â€“border);margin:6px 14px}
.sidenav-bottom{margin-top:auto;padding:12px 6px;border-top:1px solid var(â€“border)}

/* MAIN CONTENT */
.main-content{flex:1;overflow-y:auto;position:relative;z-index:5}
.page{display:none;padding:24px;min-height:100%;flex-direction:column;gap:20px}
.page.active{display:flex}

/* PAGE HEADER */
.ph{display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;gap:12px}
.ph-title h2{font-size:22px;font-weight:900;color:#fff;line-height:1.1}
.ph-title p{font-size:11px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“td);margin-top:3px;letter-spacing:1px}
.ph-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 18px;border-radius:5px;border:none;cursor:pointer;font-family:â€˜Tajawalâ€™,sans-serif;font-size:14px;font-weight:700;transition:all .2s;white-space:nowrap;text-decoration:none}
.btn-accent{background:var(â€“accent);color:#000}.btn-accent:hover{background:#fff;box-shadow:0 0 25px rgba(0,200,255,.5)}
.btn-ghost{background:none;border:1px solid var(â€“border);color:var(â€“td)}.btn-ghost:hover{border-color:var(â€“accent);color:var(â€“accent);background:rgba(0,200,255,.05)}
.btn-danger{background:rgba(255,51,51,.12);color:var(â€“danger);border:1px solid rgba(255,51,51,.25)}.btn-danger:hover{background:var(â€“danger);color:#fff}
.btn-warn{background:rgba(255,153,0,.12);color:var(â€“warn);border:1px solid rgba(255,153,0,.25)}.btn-warn:hover{background:var(â€“warn);color:#000}
.btn-ok{background:rgba(0,255,157,.08);color:var(â€“a2);border:1px solid rgba(0,255,157,.2)}.btn-ok:hover{background:var(â€“a2);color:#000}
.btn-purple{background:rgba(168,85,247,.12);color:var(â€“purple);border:1px solid rgba(168,85,247,.25)}.btn-purple:hover{background:var(â€“purple);color:#fff}
.btn-sm{padding:5px 12px;font-size:12px}
.btn-xs{padding:3px 9px;font-size:11px}

/* CONTROLS ROW */
.cr{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.sw{position:relative;flex:1;min-width:180px}
.sw input{width:100%;background:var(â€“surface);border:1px solid var(â€“border);color:var(â€“text);padding:8px 12px 8px 36px;border-radius:5px;font-family:â€˜Tajawalâ€™,sans-serif;font-size:13px;outline:none;transition:border-color .2s}
.sw input:focus{border-color:var(â€“accent)}
.sw::before{content:â€˜âŒ•â€™;position:absolute;left:10px;top:50%;transform:translateY(-50%);color:var(â€“td);font-size:16px}
.sel{background:var(â€“surface);border:1px solid var(â€“border);color:var(â€“text);padding:8px 10px;border-radius:5px;font-family:â€˜Tajawalâ€™,sans-serif;font-size:13px;outline:none;cursor:pointer}

/* CARDS */
.cards-row{display:grid;gap:14px}
.cards-4{grid-template-columns:repeat(4,1fr)}
.cards-3{grid-template-columns:repeat(3,1fr)}
.cards-2{grid-template-columns:repeat(2,1fr)}
.stat-card{background:var(â€“surface);border:1px solid var(â€“border);border-radius:8px;padding:18px;position:relative;overflow:hidden;transition:border-color .2s}
.stat-card:hover{border-color:var(â€“border2)}
.stat-card::after{content:â€™â€™;position:absolute;bottom:0;left:0;right:0;height:2px}
.sc-red::after{background:linear-gradient(90deg,var(â€“danger),transparent)}
.sc-yellow::after{background:linear-gradient(90deg,var(â€“warn),transparent)}
.sc-green::after{background:linear-gradient(90deg,var(â€“a2),transparent)}
.sc-blue::after{background:linear-gradient(90deg,var(â€“accent),transparent)}
.sc-val{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:38px;font-weight:bold;line-height:1;margin-bottom:4px}
.sc-label{font-size:13px;color:var(â€“td)}
.sc-icon{position:absolute;top:14px;left:16px;font-size:26px;opacity:.12}
.sc-red .sc-val{color:var(â€“danger)}.sc-yellow .sc-val{color:var(â€“warn)}.sc-green .sc-val{color:var(â€“a2)}.sc-blue .sc-val{color:var(â€“accent)}
.sc-change{font-size:11px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“td);margin-top:4px}

/* TABLE */
.tw{background:var(â€“surface);border:1px solid var(â€“border);border-radius:8px;overflow:hidden}
table{width:100%;border-collapse:collapse}
thead tr{background:rgba(13,51,82,.5);border-bottom:1px solid var(â€“border)}
th{padding:11px 14px;font-size:10px;font-weight:700;color:var(â€“td);text-align:right;letter-spacing:1px;font-family:â€˜Share Tech Monoâ€™,monospace;white-space:nowrap}
tbody tr{border-bottom:1px solid rgba(13,51,82,.4);transition:background .15s;animation:rowAnim .3s ease both}
tbody tr:last-child{border-bottom:none}
tbody tr:hover{background:rgba(0,200,255,.03)}
@keyframes rowAnim{from{opacity:0;transform:translateX(5px)}to{opacity:1;transform:none}}
td{padding:11px 14px;font-size:13px;vertical-align:middle}
.td-mono{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:11px;color:var(â€“td)}

/* BADGES */
.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 9px;border-radius:20px;font-size:11px;font-weight:700;letter-spacing:.3px;white-space:nowrap}
.badge::before{content:â€™â€™;width:5px;height:5px;border-radius:50%;flex-shrink:0}
.b-crit{background:rgba(255,51,51,.1);color:var(â€“danger);border:1px solid rgba(255,51,51,.25)}.b-crit::before{background:var(â€“danger);animation:blink 1.2s infinite;box-shadow:0 0 5px var(â€“danger)}
.b-warn{background:rgba(255,153,0,.1);color:var(â€“warn);border:1px solid rgba(255,153,0,.25)}.b-warn::before{background:var(â€“warn)}
.b-info{background:rgba(0,200,255,.08);color:var(â€“accent);border:1px solid rgba(0,200,255,.2)}.b-info::before{background:var(â€“accent)}
.b-ok{background:rgba(0,255,157,.07);color:var(â€“a2);border:1px solid rgba(0,255,157,.18)}.b-ok::before{background:var(â€“a2);box-shadow:0 0 5px var(â€“a2)}
.b-open{background:rgba(255,153,0,.08);color:var(â€“warn);border:1px solid rgba(255,153,0,.2)}.b-open::before{background:var(â€“warn)}
.b-resolved{background:rgba(0,255,157,.07);color:var(â€“a2);border:1px solid rgba(0,255,157,.18)}.b-resolved::before{background:var(â€“a2)}
.b-admin{background:rgba(168,85,247,.1);color:var(â€“purple);border:1px solid rgba(168,85,247,.25)}.b-admin::before{background:var(â€“purple)}
.b-tech{background:rgba(0,200,255,.08);color:var(â€“accent);border:1px solid rgba(0,200,255,.2)}.b-tech::before{background:var(â€“accent)}
.b-viewer{background:rgba(74,122,155,.15);color:var(â€“td);border:1px solid var(â€“border)}.b-viewer::before{background:var(â€“td)}
.b-online{background:rgba(0,255,157,.07);color:var(â€“a2);border:1px solid rgba(0,255,157,.18)}.b-online::before{background:var(â€“a2);box-shadow:0 0 5px var(â€“a2)}
.b-fault{background:rgba(255,51,51,.1);color:var(â€“danger);border:1px solid rgba(255,51,51,.25)}.b-fault::before{background:var(â€“danger);animation:blink 1s infinite}
.b-maint{background:rgba(255,153,0,.1);color:var(â€“warn);border:1px solid rgba(255,153,0,.25)}.b-maint::before{background:var(â€“warn)}
.b-offline{background:rgba(74,122,155,.15);color:var(â€“td);border:1px solid var(â€“border)}.b-offline::before{background:var(â€“td)}

/* RADAR CARDS */
.radar-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
.rc{background:var(â€“surface);border:1px solid var(â€“border);border-radius:10px;overflow:hidden;transition:all .2s;animation:rowAnim .3s ease both;position:relative}
.rc:hover{border-color:var(â€“border2);box-shadow:0 0 20px var(â€“glow)}
.rc-bar{height:3px;width:100%}
.rc.online .rc-bar{background:linear-gradient(90deg,var(â€“a2),transparent)}
.rc.fault .rc-bar{background:linear-gradient(90deg,var(â€“danger),transparent);animation:pulse-bar 1.5s infinite}
@keyframes pulse-bar{0%,100%{opacity:1}50%{opacity:.4}}
.rc.maintenance .rc-bar{background:linear-gradient(90deg,var(â€“warn),transparent)}
.rc.offline .rc-bar{background:linear-gradient(90deg,var(â€“td),transparent)}
.rc-body{padding:16px}
.rc-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.rc-id{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:16px;font-weight:bold;color:#fff}
.rc-name{font-size:13px;color:var(â€“td);margin-bottom:12px}
.rc-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;margin-bottom:12px}
.rcs{background:var(â€“s2);border-radius:5px;padding:7px 10px;text-align:center}
.rcs-v{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:14px;font-weight:bold;color:#fff}
.rcs-l{font-size:10px;color:var(â€“td);margin-top:2px}
.rc-progress{margin-bottom:12px}
.rcp-label{display:flex;justify-content:space-between;font-size:11px;color:var(â€“td);margin-bottom:5px}
.rcp-bar{height:5px;background:var(â€“s3);border-radius:3px;overflow:hidden}
.rcp-fill{height:100%;border-radius:3px;transition:width .8s ease}
.rc-footer{display:flex;gap:6px;padding-top:12px;border-top:1px solid var(â€“border)}

/* GAUGE */
.gauge-wrap{display:flex;justify-content:center;margin-bottom:10px}
.gauge{position:relative;width:90px;height:50px;overflow:hidden}
.gauge svg{width:90px;height:90px}

/* ACTIVITY */
.activity-item{display:flex;gap:12px;padding:11px 16px;border-bottom:1px solid rgba(13,51,82,.4);animation:rowAnim .3s ease both}
.activity-item:last-child{border-bottom:none}
.ai-icon{font-size:16px;width:22px;flex-shrink:0;text-align:center;margin-top:1px}
.ai-text{flex:1;font-size:13px;color:var(â€“text);line-height:1.5}
.ai-user{color:var(â€“accent);font-weight:700}
.ai-time{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:11px;color:var(â€“td);margin-top:2px}

/* AVATAR */
.avatar{width:32px;height:32px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;border:2px solid}
.av-a{background:rgba(168,85,247,.18);border-color:var(â€“purple);color:var(â€“purple)}
.av-t{background:rgba(0,200,255,.12);border-color:var(â€“accent);color:var(â€“accent)}
.av-v{background:rgba(74,122,155,.18);border-color:var(â€“td);color:var(â€“td)}
.member-cell{display:flex;align-items:center;gap:10px}
.mc-name{font-weight:700;color:#fff;font-size:13px}
.mc-email{font-size:11px;color:var(â€“td);font-family:â€˜Share Tech Monoâ€™,monospace;margin-top:1px}

/* READINESS METERS */
.readiness-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
.ready-card{background:var(â€“surface);border:1px solid var(â€“border);border-radius:8px;padding:16px;text-align:center;position:relative;overflow:hidden;transition:all .2s}
.ready-card:hover{border-color:var(â€“border2)}
.ready-ring{width:90px;height:90px;margin:0 auto 12px;position:relative}
.ready-ring svg{transform:rotate(-90deg)}
.ready-ring .bg-circle{stroke:var(â€“s3);stroke-width:6;fill:none}
.ready-ring .fg-circle{stroke-width:6;fill:none;stroke-linecap:round;transition:stroke-dashoffset 1s ease}
.ready-pct{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:â€˜Share Tech Monoâ€™,monospace;font-size:16px;font-weight:bold}
.ready-name{font-size:13px;font-weight:700;color:#fff;margin-bottom:3px}
.ready-loc{font-size:11px;color:var(â€“td)}

/* MODAL */
.mo{display:none;position:fixed;inset:0;background:rgba(4,13,22,.93);z-index:800;align-items:center;justify-content:center;backdrop-filter:blur(6px)}
.mo.open{display:flex}
.modal{background:var(â€“s2);border:1px solid var(â€“border2);border-radius:10px;width:96%;max-width:660px;max-height:92vh;overflow-y:auto;box-shadow:0 0 60px rgba(0,200,255,.2);animation:mIn .3s ease}
.modal-lg{max-width:820px}
@keyframes mIn{from{opacity:0;transform:scale(.95) translateY(-15px)}to{opacity:1;transform:none}}
.mh{display:flex;align-items:center;justify-content:space-between;padding:18px 22px;border-bottom:1px solid var(â€“border)}
.mh h3{font-size:16px;font-weight:700;color:var(â€“accent);display:flex;align-items:center;gap:8px}
.mx{background:none;border:none;color:var(â€“td);font-size:20px;cursor:pointer;padding:3px 6px;border-radius:3px;line-height:1;transition:color .2s}
.mx:hover{color:#fff}
.mb{padding:22px}
.mf{display:flex;justify-content:flex-end;gap:8px;padding:14px 22px;border-top:1px solid var(â€“border)}

/* FORM */
.fg{margin-bottom:16px}
.fl{display:block;font-size:11px;color:var(â€“td);margin-bottom:6px;letter-spacing:.5px}
.fi,.fs,.ft{width:100%;background:var(â€“bg);border:1px solid var(â€“border);color:var(â€“text);padding:9px 12px;border-radius:5px;font-family:â€˜Tajawalâ€™,sans-serif;font-size:14px;outline:none;transition:border-color .2s}
.fi:focus,.fs:focus,.ft:focus{border-color:var(â€“accent)}
.ft{min-height:85px;resize:vertical}
.fi::placeholder{color:var(â€“td)}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.fr3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}

/* CONFIRM */
.confirm-card{max-width:440px}
.confirm-body{padding:30px 24px;text-align:center}
.confirm-icon{font-size:48px;margin-bottom:14px}
.confirm-msg{font-size:17px;font-weight:900;color:#fff;margin-bottom:6px}
.confirm-sub{font-size:13px;color:var(â€“td)}

/* SETTINGS */
.sg{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.sc{background:var(â€“surface);border:1px solid var(â€“border);border-radius:8px;padding:20px}
.sc-title{font-size:12px;font-weight:700;color:#fff;margin-bottom:14px;padding-bottom:10px;border-bottom:1px solid var(â€“border);display:flex;align-items:center;gap:8px;letter-spacing:.5px}
.tr{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid rgba(13,51,82,.35)}
.tr:last-child{border-bottom:none}
.tr-l{font-size:13px;color:var(â€“text)}
.toggle{width:38px;height:20px;background:var(â€“border2);border-radius:20px;cursor:pointer;position:relative;border:none;transition:background .2s;flex-shrink:0}
.toggle::after{content:â€™â€™;position:absolute;top:3px;right:3px;width:14px;height:14px;background:#fff;border-radius:50%;transition:transform .2s}
.toggle.on{background:var(â€“accent)}.toggle.on::after{transform:translateX(-18px)}

/* TOAST */
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:var(â€“s2);border:1px solid var(â€“accent);color:var(â€“accent);padding:11px 22px;border-radius:7px;font-size:14px;z-index:9999;transition:transform .3s;box-shadow:0 0 30px rgba(0,200,255,.25);white-space:nowrap;font-weight:600}
.toast.show{transform:translateX(-50%) translateY(0)}
.toast.danger{border-color:var(â€“danger);color:var(â€“danger);box-shadow:0 0 30px rgba(255,51,51,.2)}
.toast.ok{border-color:var(â€“a2);color:var(â€“a2);box-shadow:0 0 30px rgba(0,255,157,.2)}
.toast.warn{border-color:var(â€“warn);color:var(â€“warn)}

/* PROFILE MODAL */
.profile-grid{display:grid;grid-template-columns:120px 1fr;gap:20px;align-items:start}
.profile-avatar-big{width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:700;margin:0 auto 12px}
.profile-avatar-wrap{text-align:center}

/* EMPTY */
.empty{text-align:center;padding:48px 20px;color:var(â€“td)}
.empty .ei{font-size:40px;opacity:.25;margin-bottom:10px}
.empty p{font-size:14px}

/* DETAIL BLOCK */
.db{background:var(â€“bg);border:1px solid var(â€“border);border-radius:6px;padding:14px;margin-bottom:14px}
.dkv{display:flex;gap:8px;margin-bottom:7px;font-size:13px;align-items:flex-start}
.dkv:last-child{margin-bottom:0}
.dk{color:var(â€“td);min-width:120px;flex-shrink:0}
.dv{color:#fff;font-weight:600;flex:1;line-height:1.5}
.tl-item{display:flex;gap:12px;padding:9px 0;border-bottom:1px solid rgba(13,51,82,.35);font-size:13px}
.tl-item:last-child{border-bottom:none}
.tl-t{font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“td);font-size:11px;min-width:85px;padding-top:1px}
.tl-e{color:var(â€“text)}

/* SECTION LABEL */
.sec-label{font-size:11px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“accent);letter-spacing:2px;text-transform:uppercase;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(â€“border)}

/* HORIZONTAL DIVIDER */
.hdiv{height:1px;background:var(â€“border);margin:4px 0}

/* SCROLLBAR */
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:var(â€“bg)}
::-webkit-scrollbar-thumb{background:var(â€“border2);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(â€“accent)}

/* FAULT PRIORITY INDICATOR */
.fp-indicator{display:flex;align-items:center;gap:6px;font-size:12px}
.fp-bar{display:flex;gap:2px}
.fp-seg{width:8px;height:12px;border-radius:1px;background:var(â€“border2)}
.fp-seg.active-crit{background:var(â€“danger)}
.fp-seg.active-warn{background:var(â€“warn)}
.fp-seg.active-info{background:var(â€“accent)}

/* ONLINE STATUS PULSE */
.status-pulse{display:inline-flex;align-items:center;gap:6px}
.sp-dot{width:8px;height:8px;border-radius:50%;position:relative}
.sp-dot.online{background:var(â€“a2);box-shadow:0 0 8px rgba(0,255,157,.7)}
.sp-dot.online::after{content:â€™â€™;position:absolute;inset:-4px;border-radius:50%;border:1px solid rgba(0,255,157,.3);animation:ripple 2s infinite}
.sp-dot.fault{background:var(â€“danger);animation:blink 1s infinite}
.sp-dot.maintenance{background:var(â€“warn)}
.sp-dot.offline{background:var(â€“td)}
@keyframes ripple{to{transform:scale(2);opacity:0}}

/* PROGRESS BAR */
.prog-bar{height:6px;background:var(â€“s3);border-radius:3px;overflow:hidden}
.prog-fill{height:100%;border-radius:3px;transition:width 1s ease}

/* NOTIFICATION BELL */
.notif-btn{width:32px;height:32px;border-radius:50%;border:1px solid var(â€“border);background:none;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;color:var(â€“td);transition:all .2s;position:relative}
.notif-btn:hover{border-color:var(â€“accent);color:var(â€“accent)}
.notif-badge{position:absolute;top:-3px;left:-3px;width:14px;height:14px;background:var(â€“danger);border-radius:50%;font-size:9px;color:#fff;display:flex;align-items:center;justify-content:center;font-family:â€˜Share Tech Monoâ€™,monospace;font-weight:bold;border:2px solid var(â€“bg)}

/* SECTION HEADER */
.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.sh-title{font-size:11px;font-family:â€˜Share Tech Monoâ€™,monospace;color:var(â€“accent);letter-spacing:2px;text-transform:uppercase}

/* CHART MINI */
.mini-chart{display:flex;flex-direction:column;gap:8px}
.mch-row{display:flex;align-items:center;gap:10px}
.mch-label{font-size:11px;color:var(â€“td);min-width:90px;text-align:right}
.mch-bar-wrap{flex:1;height:10px;background:var(â€“s3);border-radius:2px;overflow:hidden}
.mch-bar{height:100%;border-radius:2px;transition:width 1s ease}
.mch-val{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:11px;color:var(â€“td);min-width:20px;text-align:left}

/* UPTIME DISPLAY */
.uptime-display{font-family:â€˜Share Tech Monoâ€™,monospace;font-size:28px;color:var(â€“accent);text-align:center;letter-spacing:3px;margin:10px 0}
.uptime-label{text-align:center;font-size:11px;color:var(â€“td);letter-spacing:1px}

/* TWO-COLUMN LAYOUT */
.two-col{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.three-col{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}

/* NOTIFICATION PANEL */
.notif-panel{position:absolute;top:calc(100% + 8px);left:0;width:320px;background:var(â€“surface);border:1px solid var(â€“border2);border-radius:8px;box-shadow:0 8px 32px rgba(0,0,0,.4);z-index:999;display:none;overflow:hidden}
.notif-panel.open{display:block}
.np-header{padding:12px 16px;border-bottom:1px solid var(â€“border);display:flex;justify-content:space-between;align-items:center}
.np-header h4{font-size:13px;font-weight:700;color:#fff}
.np-item{display:flex;gap:10px;padding:11px 16px;border-bottom:1px solid rgba(13,51,82,.4);cursor:pointer;transition:background .15s}
.np-item:hover{background:var(â€“s2)}
.np-item:last-child{border-bottom:none}
.np-icon{font-size:18px;flex-shrink:0;margin-top:1px}
.np-text{font-size:12px;color:var(â€“text);line-height:1.5;flex:1}
.np-time{font-size:10px;color:var(â€“td);font-family:â€˜Share Tech Monoâ€™,monospace;margin-top:2px}
.np-unread{background:rgba(0,200,255,.04)}

/* RESPONSIVE */
@media(max-width:960px){
.cards-4{grid-template-columns:1fr 1fr}
.sg{grid-template-columns:1fr}
.two-col,.three-col{grid-template-columns:1fr}
.sidenav{width:56px}
.ni span:not(.ico){display:none}
.ni-badge{display:none}
.nav-s{display:none}
}
</style>

</head>
<body>
<div class="grid-bg"></div>
<div class="vignette"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LOGIN PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="loginPage">
  <div style="position:absolute;inset:0;overflow:hidden;pointer-events:none">
    <!-- Animated radar circles -->
    <svg style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:800px;height:800px;opacity:.04" viewBox="0 0 800 400"><circle cx="400" cy="400" r="380" stroke="#00c8ff" stroke-width="1" fill="none"/><circle cx="400" cy="400" r="280" stroke="#00c8ff" stroke-width="1" fill="none"/><circle cx="400" cy="400" r="180" stroke="#00c8ff" stroke-width="1" fill="none"/><circle cx="400" cy="400" r="80" stroke="#00c8ff" stroke-width="1" fill="none"/><line x1="0" y1="400" x2="800" y2="400" stroke="#00c8ff" stroke-width=".5"/><line x1="400" y1="0" x2="400" y2="800" stroke="#00c8ff" stroke-width=".5"/></svg>
  </div>

  <div class="login-wrap">
    <div class="login-logo">
      <div class="login-radar-icon">
        <svg viewBox="0 0 80 80" fill="none">
          <circle cx="40" cy="40" r="38" stroke="#0d3352" stroke-width="1.5"/>
          <circle cx="40" cy="40" r="26" stroke="#0d3352" stroke-width="1"/>
          <circle cx="40" cy="40" r="14" stroke="#0d3352" stroke-width="1"/>
          <circle cx="40" cy="40" r="3" fill="#00c8ff"/>
          <line x1="40" y1="40" x2="72" y2="18" stroke="#00c8ff" stroke-width="2" stroke-linecap="round" opacity=".8">
            <animateTransform attributeName="transform" type="rotate" from="0 40 40" to="360 40 40" dur="3s" repeatCount="indefinite"/>
          </line>
          <circle cx="60" cy="22" r="3" fill="#00ff9d" opacity=".9">
            <animate attributeName="opacity" values=".9;.2;.9" dur="1.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="20" cy="55" r="2" fill="#ff9900" opacity=".8">
            <animate attributeName="opacity" values=".8;.1;.8" dur="2s" repeatCount="indefinite"/>
          </circle>
        </svg>
      </div>
      <h1>Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©</h1>
      <p>COASTAL RADAR MANAGEMENT SYSTEM</p>
    </div>

```
<div class="login-card">
  <div class="login-section-title">AUTHENTICATION REQUIRED</div>
  <div class="login-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>

  <div class="login-error" id="loginError">âš  Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©</div>
  
  <div class="form-group">
    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
    <input class="form-input" id="loginUser" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" autocomplete="username">
  </div>
  <div class="form-group">
    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
    <input class="form-input" id="loginPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
  </div>

  <button class="login-btn" onclick="doLogin()">Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</button>

  <div style="text-align:center;margin-top:14px">
    <button onclick="openResetModal()" style="background:none;border:none;color:var(--td);font-size:12px;font-family:'Tajawal',sans-serif;cursor:pointer;letter-spacing:.5px;transition:color .2s" onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color='var(--td)'">
      ğŸ”‘ Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¹Ø¨Ø± Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„
    </button>
  </div>

  <div style="display:flex;align-items:center;justify-content:center;gap:8px;margin-top:12px">
    <div style="width:6px;height:6px;border-radius:50%;background:var(--a2);animation:blink 2s infinite"></div>
    <span style="font-size:11px;font-family:'Share Tech Mono',monospace;color:var(--td);letter-spacing:1px">SECURE ACCESS â€” AUTHORIZED PERSONNEL ONLY</span>
  </div>
</div>
```

  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="appShell">
  <!-- TOP BAR -->
  <div class="topbar">
    <div class="topbar-logo">
      <svg viewBox="0 0 32 32" fill="none"><circle cx="16" cy="16" r="14" stroke="#0d3352" stroke-width="1"/><circle cx="16" cy="16" r="9" stroke="#0d3352" stroke-width=".8"/><circle cx="16" cy="16" r="1.5" fill="#00c8ff"/><line x1="16" y1="16" x2="28" y2="8" stroke="#00c8ff" stroke-width="1.2" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" from="0 16 16" to="360 16 16" dur="3s" repeatCount="indefinite"/></line></svg>
      <div class="tl-text"><h1>Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©</h1><span>COASTAL RADAR SYSTEM</span></div>
    </div>

```
<div class="ticker-wrap">
  <div style="display:flex;align-items:center;gap:6px;overflow:hidden">
    <div class="ticker-dot"></div>
    <div class="ticker" id="tickerText">SYSTEM ONLINE â— Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ØªØ¹Ù…Ù„ â— RADAR-01 ONLINE â— RADAR-02 FAULT â— RADAR-03 MAINTENANCE â— RADAR-04 ONLINE â— RADAR-05 ONLINE â— RADAR-06 MAINTENANCE â— SYSTEM ONLINE â— Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ØªØ¹Ù…Ù„ â— RADAR-01 ONLINE â— RADAR-02 FAULT â—</div>
  </div>
</div>

<div class="topbar-right">
  <div class="topbar-stat ts-crit"><div class="ts-v" id="tsC">0</div><div class="ts-l">Ø­Ø±Ø¬</div></div>
  <div class="topbar-stat ts-warn"><div class="ts-v" id="tsW">0</div><div class="ts-l">ØªØ­Ø°ÙŠØ±</div></div>
  <div class="topbar-stat ts-ok"><div class="ts-v" id="tsOK">0</div><div class="ts-l">Ù…Ø­Ù„ÙˆÙ„</div></div>
  <div class="topbar-stat ts-blue"><div class="ts-v" id="tsR">0</div><div class="ts-l">Ø±Ø§Ø¯Ø§Ø±</div></div>
  <div class="topbar-divider"></div>
  <div class="topbar-clock" id="clock">00:00:00</div>
  
  <!-- Notifications -->
  <div style="position:relative">
    <button class="notif-btn" onclick="toggleNotif()">
      ğŸ””
      <div class="notif-badge" id="notifCount">3</div>
    </button>
    <div class="notif-panel" id="notifPanel">
      <div class="np-header"><h4>Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</h4><button class="btn btn-ghost btn-xs" onclick="clearNotif()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button></div>
      <div id="notifList"></div>
    </div>
  </div>

  <!-- User menu -->
  <div class="topbar-user" onclick="toggleUserMenu()" id="userBtn">
    <div class="tu-avatar av-a" id="topAvatar">Ù…</div>
    <div><div class="tu-name" id="topName">Ø§Ù„Ù…Ø¯ÙŠØ±</div><div class="tu-role" id="topRole">Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</div></div>
    <span style="font-size:10px;color:var(--td)">â–¾</span>
    <div class="user-dropdown" id="userDropdown">
      <div class="ud-item" onclick="openProfileModal()">ğŸ‘¤ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</div>
      <div class="ud-item" onclick="goto('settings')">âš™ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
      <div class="ud-divider"></div>
      <div class="ud-item danger" onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</div>
    </div>
  </div>
</div>
```

  </div>

  <div class="app-body">
    <!-- SIDE NAV -->
    <nav class="sidenav">
      <div class="nav-s">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
      <div class="ni active" onclick="goto('dashboard',this)" id="nav-dashboard"><span class="ico">ğŸ“Š</span><span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span></div>

```
  <div class="nav-s">Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</div>
  <div class="ni" onclick="goto('radars',this)" id="nav-radars"><span class="ico">ğŸ“¡</span><span>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</span></div>
  <div class="ni" onclick="goto('readiness',this)" id="nav-readiness"><span class="ico">ğŸ¯</span><span>Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©</span></div>

  <div class="nav-s">Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</div>
  <div class="ni" onclick="goto('faults',this)" id="nav-faults"><span class="ico">âš </span><span>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</span><span class="ni-badge red" id="navFaultBadge">0</span></div>

  <div class="nav-div" id="adminNav"></div>
  <div class="nav-s" id="adminNavS" style="display:none">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
  <div class="ni" onclick="goto('members',this)" id="nav-members" style="display:none"><span class="ico">ğŸ‘¥</span><span>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</span></div>
  <div class="ni" onclick="goto('settings',this)" id="nav-settings" style="display:none"><span class="ico">âš™</span><span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></div>
  <div class="ni" onclick="goto('actlog',this)" id="nav-actlog" style="display:none"><span class="ico">ğŸ“‹</span><span>Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·</span></div>

  <div class="sidenav-bottom">
    <div class="ni" onclick="logout()" style="color:var(--danger)"><span class="ico">ğŸšª</span><span>Ø®Ø±ÙˆØ¬</span></div>
  </div>
</nav>

<!-- PAGES -->
<div class="main-content">

  <!-- â•â• DASHBOARD â•â• -->
  <div class="page active" id="page-dashboard">
    <div class="ph">
      <div class="ph-title"><h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2><p>DASHBOARD â€” Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©</p></div>
      <div class="ph-actions" id="dashActions"></div>
    </div>

    <div class="cards-row cards-4" id="dashStats"></div>

    <div class="two-col">
      <div>
        <div class="sh"><div class="sh-title">Ø¢Ø®Ø± Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</div><button class="btn btn-ghost btn-sm" onclick="goto('faults')">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button></div>
        <div class="tw"><table><thead><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</th><th>Ø§Ù„Ø¹Ø·Ù„</th><th>Ø§Ù„Ø®Ø·ÙˆØ±Ø©</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead><tbody id="dashFaultsTable"></tbody></table></div>
      </div>
      <div>
        <div class="sh"><div class="sh-title">Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</div><button class="btn btn-ghost btn-sm" onclick="goto('radars')">Ø§Ù„ØªÙØ§ØµÙŠÙ„</button></div>
        <div class="tw"><table><thead><tr><th>Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©</th></tr></thead><tbody id="dashRadarsTable"></tbody></table></div>
      </div>
    </div>

    <div class="two-col">
      <div>
        <div class="sh"><div class="sh-title">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹</div></div>
        <div class="tw" style="padding:16px"><div class="mini-chart" id="faultTypeChart"></div></div>
      </div>
      <div>
        <div class="sh"><div class="sh-title">Ø¢Ø®Ø± Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</div></div>
        <div class="tw" id="dashActivity"></div>
      </div>
    </div>
  </div>

  <!-- â•â• RADARS MONITORING â•â• -->
  <div class="page" id="page-radars">
    <div class="ph">
      <div class="ph-title"><h2>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</h2><p>RADAR MONITORING â€” Ø­Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©</p></div>
      <div class="ph-actions" id="radarActions">
        <button class="btn btn-ghost btn-sm" onclick="refreshRadarStatus()">â†» ØªØ­Ø¯ÙŠØ«</button>
      </div>
    </div>

    <div class="cr">
      <div class="sw"><input type="text" id="radarSearch" placeholder="Ø¨Ø­Ø«..." oninput="renderRadarPage()"></div>
      <select class="sel" id="radarStatFilter" onchange="renderRadarPage()">
        <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
        <option value="online">ÙŠØ¹Ù…Ù„</option>
        <option value="fault">Ø¹Ø·Ù„</option>
        <option value="maintenance">ØµÙŠØ§Ù†Ø©</option>
        <option value="offline">ØºÙŠØ± Ù…ØªØµÙ„</option>
      </select>
    </div>

    <!-- Summary row -->
    <div class="cards-row cards-4" id="radarSummaryCards"></div>

    <div class="radar-grid" id="radarGrid"></div>
  </div>

  <!-- â•â• READINESS â•â• -->
  <div class="page" id="page-readiness">
    <div class="ph">
      <div class="ph-title"><h2>Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</h2><p>READINESS STATUS â€” ØªÙ‚Ø±ÙŠØ± Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</p></div>
    </div>

    <!-- Overall gauge -->
    <div class="cards-row cards-3" id="readinessTopCards"></div>

    <div class="two-col">
      <div>
        <div class="sh"><div class="sh-title">Ø¬Ø§Ù‡Ø²ÙŠØ© ÙƒÙ„ Ø±Ø§Ø¯Ø§Ø±</div></div>
        <div class="readiness-grid" id="readinessGrid"></div>
      </div>
      <div style="display:flex;flex-direction:column;gap:16px">
        <div>
          <div class="sh"><div class="sh-title">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠ</div></div>
          <div class="tw" style="padding:16px">
            <div class="mini-chart" id="readinessMonthChart"></div>
          </div>
        </div>
        <div>
          <div class="sh"><div class="sh-title">ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ</div></div>
          <div class="tw" style="padding:20px">
            <div class="uptime-display" id="uptimeDisplay">---</div>
            <div class="uptime-label">ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ù†Ø° Ø¢Ø®Ø± Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„</div>
            <div style="margin-top:16px">
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px" id="uptimeStats"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div>
      <div class="sh"><div class="sh-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ù„ÙƒÙ„ Ø±Ø§Ø¯Ø§Ø±</div></div>
      <div class="tw"><table><thead><tr><th>Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th><th>Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© %</th><th>Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„</th><th>Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±</th><th>Ø¢Ø®Ø± ØµÙŠØ§Ù†Ø©</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead><tbody id="readinessTable"></tbody></table></div>
    </div>
  </div>

  <!-- â•â• FAULTS â•â• -->
  <div class="page" id="page-faults">
    <div class="ph">
      <div class="ph-title"><h2>Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</h2><p>FAULT LOG â€” ØªØ³Ø¬ÙŠÙ„ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</p></div>
      <div class="ph-actions">
        <button class="btn btn-accent" onclick="openFaultModal()">+ ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„</button>
        <button class="btn btn-ghost btn-sm" onclick="exportFaults()">â¬‡ ØªØµØ¯ÙŠØ±</button>
      </div>
    </div>

    <div class="cards-row cards-4" id="faultStatsCards"></div>

    <div class="cr">
      <div class="sw"><input type="text" id="faultSearch" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„..." oninput="renderFaults()"></div>
      <select class="sel" id="fSev" onchange="renderFaults()"><option value="">ÙƒÙ„ Ø§Ù„Ø®Ø·ÙˆØ±Ø§Øª</option><option value="critical">Ø­Ø±Ø¬Ø©</option><option value="warning">ØªØ­Ø°ÙŠØ±Ø§Øª</option><option value="info">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option></select>
      <select class="sel" id="fStat" onchange="renderFaults()"><option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option><option value="open">Ù…ÙØªÙˆØ­Ø©</option><option value="resolved">Ù…Ø­Ù„ÙˆÙ„Ø©</option></select>
      <select class="sel" id="fRad" onchange="renderFaults()"><option value="">ÙƒÙ„ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</option></select>
    </div>

    <div class="tw">
      <table>
        <thead><tr><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</th><th>Ø§Ù„Ø¹Ø·Ù„</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø®Ø·ÙˆØ±Ø©</th><th>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
        <tbody id="faultsBody"></tbody>
      </table>
    </div>
  </div>

  <!-- â•â• MEMBERS â•â• -->
  <div class="page" id="page-members">
    <div class="ph">
      <div class="ph-title"><h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h2><p>MEMBERS â€” Ø¥Ø¯Ø§Ø±Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p></div>
      <div class="ph-actions"><button class="btn btn-accent" onclick="openMemberModal()">+ Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ</button></div>
    </div>

    <div class="cr">
      <div class="sw"><input type="text" id="memberSearch" placeholder="Ø¨Ø­Ø«..." oninput="renderMembers()"></div>
      <select class="sel" id="memberRoleF" onchange="renderMembers()"><option value="">ÙƒÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±</option><option value="admin">Ù…Ø¯ÙŠØ±</option><option value="tech">ØªÙ‚Ù†ÙŠ</option><option value="viewer">Ù…Ø±Ø§Ù‚Ø¨</option></select>
    </div>

    <div class="tw">
      <table>
        <thead><tr><th>Ø§Ù„Ø¹Ø¶Ùˆ</th><th>Ø§Ù„Ø¯ÙˆØ±</th><th>Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</th><th>Ø£Ø¹Ø·Ø§Ù„ Ù…ØºÙ„Ù‚Ø©</th><th>Ø¢Ø®Ø± Ø¯Ø®ÙˆÙ„</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead>
        <tbody id="membersBody"></tbody>
      </table>
    </div>
  </div>

  <!-- â•â• SETTINGS â•â• -->
  <div class="page" id="page-settings">
    <div class="ph">
      <div class="ph-title"><h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2><p>SETTINGS â€” Ø¶Ø¨Ø· ÙˆØªØ®ØµÙŠØµ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©</p></div>
      <div class="ph-actions"><button class="btn btn-accent" onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button></div>
    </div>

    <div id="settingsBar" style="display:none;background:rgba(0,255,157,.06);border:1px solid rgba(0,255,157,.2);border-radius:7px;padding:11px 18px;font-size:13px;color:var(--a2);display:none;align-items:center;gap:10px">
      <span>âœ“</span><span id="settingsBarMsg"></span>
    </div>

    <div class="sg">
      <!-- Ø¹Ø§Ù… -->
      <div class="sc">
        <div class="sc-title">âš™ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©</div>
        <div class="fg"><label class="fl">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©</label><input class="fi" id="sName" value="Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ© â€“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©"></div>
        <div class="fg"><label class="fl">Ø¨Ø±ÙŠØ¯ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</label><input class="fi" id="sEmail" value="alerts@coastal-radar.gov" type="email"></div>
        <div class="fg"><label class="fl">ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù†Ø¸Ø§Ù…</label>
          <select class="fs" id="sTimezone">
            <option value="AST+3" selected>Arabia Standard Time (AST +3)</option>
            <option value="UTC+0">UTC+0</option><option value="UTC+4">UTC+4</option>
          </select>
        </div>
        <div class="fg"><label class="fl">Ø§Ù„ÙˆØµÙ</label><textarea class="ft" id="sDesc" style="min-height:60px">Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©</textarea></div>
      </div>

      <!-- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
      <div class="sc">
        <div class="sc-title">ğŸ”” Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</div>
        <div class="tr"><span class="tr-l">ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯ Ø¹Ø·Ù„ Ø­Ø±Ø¬</span><button class="toggle on" id="tog-notif-critical" onclick="doToggle(this,'notif_critical')"></button></div>
        <div class="tr"><span class="tr-l">ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯ Ø£ÙŠ Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯</span><button class="toggle on" id="tog-notif-any" onclick="doToggle(this,'notif_any')"></button></div>
        <div class="tr"><span class="tr-l">Ù…Ù„Ø®Øµ ÙŠÙˆÙ…ÙŠ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯</span><button class="toggle" id="tog-notif-daily" onclick="doToggle(this,'notif_daily')"></button></div>
        <div class="tr"><span class="tr-l">ØªÙ†Ø¨ÙŠÙ‡ Ø§ØªØµØ§Ù„/Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø±Ø§Ø¯Ø§Ø±</span><button class="toggle on" id="tog-notif-radar" onclick="doToggle(this,'notif_radar')"></button></div>
        <div class="tr"><span class="tr-l">ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</span><button class="toggle" id="tog-notif-sound" onclick="doToggle(this,'notif_sound')"></button></div>
        <div class="tr"><span class="tr-l">Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ (Push)</span><button class="toggle" id="tog-notif-push" onclick="doToggle(this,'notif_push');reqPush(this)"></button></div>
        <div style="margin-top:12px;padding:9px 12px;background:var(--bg);border:1px solid var(--border);border-radius:5px;font-size:12px;color:var(--td)">
          Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…ÙØ¹Ù‘Ù„Ø©: <span id="activeNotifCount" style="color:var(--accent);font-family:'Share Tech Mono',monospace;font-size:13px;font-weight:bold">5</span>
        </div>
      </div>

      <!-- Ø§Ù„Ø£Ù…Ø§Ù† -->
      <div class="sc">
        <div class="sc-title">ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†</div>
        <div class="tr"><span class="tr-l">Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ© (2FA)</span><button class="toggle" id="tog-sec-2fa" onclick="doToggle(this,'sec_2fa')"></button></div>
        <div class="tr"><span class="tr-l">Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø®Ù…ÙˆÙ„</span><button class="toggle on" id="tog-sec-auto" onclick="doToggle(this,'sec_auto')"></button></div>
        <div class="tr" style="padding-right:16px">
          <span class="tr-l" style="font-size:12px">Ù…Ø¯Ø© Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
          <select class="sel" id="sAutoLogout" style="font-size:12px;padding:4px 8px" onchange="sysSet.auto_logout=+this.value">
            <option value="15">15 Ø¯Ù‚ÙŠÙ‚Ø©</option><option value="30" selected>30 Ø¯Ù‚ÙŠÙ‚Ø©</option>
            <option value="60">Ø³Ø§Ø¹Ø©</option><option value="120">Ø³Ø§Ø¹ØªØ§Ù†</option>
          </select>
        </div>
        <div class="tr"><span class="tr-l">ØªØ³Ø¬ÙŠÙ„ Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span><button class="toggle on" id="tog-sec-log" onclick="doToggle(this,'sec_log')"></button></div>
        <div class="tr"><span class="tr-l">Ù‚ÙÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ø¹Ø¯ 5 Ù…Ø­Ø§ÙˆÙ„Ø§Øª</span><button class="toggle on" id="tog-sec-lock" onclick="doToggle(this,'sec_lock')"></button></div>
        <div style="height:10px"></div>
        <div style="font-size:11px;color:var(--td);margin-bottom:8px;font-family:'Share Tech Mono',monospace;letter-spacing:1px">CHANGE ADMIN PASSWORD</div>
        <div class="fg"><label class="fl">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label><input class="fi" id="sOldPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
        <div class="fg"><label class="fl">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label><input class="fi" id="sNewPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" oninput="passStrBar(this.value,'sPSFill','sPSLbl')"></div>
        <div id="sPSFill" style="height:4px;background:var(--s3);border-radius:2px;margin:-10px 0 8px;overflow:hidden"><div id="sPSFill_inner" style="height:100%;width:0;border-radius:2px;transition:all .3s"></div></div>
        <div id="sPSLbl" style="font-size:10px;color:var(--td);margin-bottom:10px"></div>
        <div class="fg"><label class="fl">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label><input class="fi" id="sNewPass2" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
        <button class="btn btn-warn btn-sm" style="width:100%" onclick="changeMyPassword()">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
        <div id="myPassMsg" style="display:none;margin-top:8px;padding:9px 13px;border-radius:5px;font-size:12px"></div>
      </div>

      <!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© -->
      <div class="sc">
        <div class="sc-title">ğŸ¨ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ù„Ø¹Ø±Ø¶</div>
        <div class="tr"><span class="tr-l">ØªØ£Ø«ÙŠØ± Ø§Ù„Ø´Ø¨ÙƒØ© ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©</span><button class="toggle on" id="tog-ui-grid" onclick="doToggle(this,'ui_grid');applyGrid()"></button></div>
        <div class="tr"><span class="tr-l">Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ</span><button class="toggle on" id="tog-ui-ticker" onclick="doToggle(this,'ui_ticker');applyTicker()"></button></div>
        <div class="tr"><span class="tr-l">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</span><button class="toggle on" id="tog-ui-refresh" onclick="doToggle(this,'ui_refresh')"></button></div>
        <div class="tr"><span class="tr-l">ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© (Animations)</span><button class="toggle on" id="tog-ui-anim" onclick="doToggle(this,'ui_anim');applyAnims()"></button></div>
        <div class="tr"><span class="tr-l">Ù†Ø¨Ø¶Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</span><button class="toggle on" id="tog-ui-pulse" onclick="doToggle(this,'ui_pulse')"></button></div>
        <div style="height:10px"></div>
        <div class="fg"><label class="fl">Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ø§Ù„ØµÙØ­Ø©</label>
          <select class="fs" id="sPageSize" onchange="sysSet.page_size=+this.value">
            <option value="25">25</option><option value="50" selected>50</option><option value="100">100</option>
          </select>
        </div>
        <button class="btn btn-danger btn-sm" style="width:100%;margin-top:4px" onclick="confirmAction('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ',()=>{faults=[];renderAll();logAct('ğŸ—‘','Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„');showToast('ØªÙ… Ø§Ù„Ù…Ø³Ø­','ok')})">ğŸ—‘ Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</button>
      </div>
    </div>
  </div>

  <!-- â•â• ACTIVITY LOG â•â• -->
  <div class="page" id="page-actlog">
    <div class="ph">
      <div class="ph-title"><h2>Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·</h2><p>ACTIVITY LOG â€” Ø¬Ù…ÙŠØ¹ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p></div>
      <div class="ph-actions"><button class="btn btn-ghost btn-sm" onclick="actLog=[];renderActLog();showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„','ok')">ğŸ—‘ Ù…Ø³Ø­</button></div>
    </div>
    <div class="tw"><table><thead><tr><th>Ø§Ù„ÙˆÙ‚Øª</th><th>Ø§Ù„Ø­Ø¯Ø«</th><th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th><th>Ø§Ù„Ø¯ÙˆØ±</th></tr></thead><tbody id="actLogBody"></tbody></table></div>
  </div>

</div><!-- /main-content -->
```

  </div><!-- /app-body -->
</div><!-- /appShell -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- Fault Modal -->

<div class="mo" id="faultModal">
<div class="modal modal-lg">
  <div class="mh"><h3 id="faultModalTitle">âš  ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯</h3><button class="mx" onclick="closeMo('faultModal')">âœ•</button></div>
  <div class="mb">
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</label><select class="fs" id="fmRad"></select></div>
      <div class="fg"><label class="fl">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©</label><select class="fs" id="fmSev"><option value="critical">ğŸ”´ Ø­Ø±Ø¬</option><option value="warning">ğŸŸ¡ ØªØ­Ø°ÙŠØ±</option><option value="info">ğŸ”µ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option></select></div>
    </div>
    <div class="fg"><label class="fl">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø·Ù„</label><input class="fi" id="fmTitle" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ø¹Ø·Ù„..."></div>
    <div class="fr">
      <div class="fg"><label class="fl">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„</label><select class="fs" id="fmType"><option>Ø¹Ø·Ù„ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ</option><option>Ø¹Ø·Ù„ Ø§ØªØµØ§Ù„</option><option>Ø¹Ø·Ù„ Ø¨Ø±Ù…Ø¬ÙŠ</option><option>Ø¹Ø·Ù„ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ</option><option>Ø¹Ø·Ù„ Ù‡ÙˆØ§Ø¦ÙŠ</option><option>Ø£Ø®Ø±Ù‰</option></select></div>
      <div class="fg"><label class="fl">Ø§Ù„ØªÙ‚Ù†ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label><select class="fs" id="fmTech"></select></div>
    </div>
    <div class="fg"><label class="fl">ÙˆØµÙ Ø§Ù„Ø¹Ø·Ù„</label><textarea class="ft" id="fmDesc" placeholder="Ø§Ø°ÙƒØ± Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„..."></textarea></div>
    <div class="fg"><label class="fl">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ®Ø°Ø©</label><textarea class="ft" id="fmAct" placeholder="Ù…Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙŠ Ø§ØªØ®Ø°ØªÙ‡Ø§ØŸ" style="min-height:70px"></textarea></div>
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©)</label><input class="fi" id="fmTags" placeholder="ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ Ø¹Ø§Ø¬Ù„ØŒ Ù‡ÙˆØ§Ø¦ÙŠ"></div>
      <div class="fg"><label class="fl">Ø§Ù„Ø­Ø§Ù„Ø©</label><select class="fs" id="fmStat"><option value="open">Ù…ÙØªÙˆØ­</option><option value="resolved">Ù…Ø­Ù„ÙˆÙ„</option></select></div>
    </div>
  </div>
  <div class="mf"><button class="btn btn-ghost" onclick="closeMo('faultModal')">Ø¥Ù„ØºØ§Ø¡</button><button class="btn btn-accent" onclick="saveFault()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ø·Ù„</button></div>
</div>
</div>

<!-- Fault Detail Modal -->

<div class="mo" id="fdModal">
<div class="modal modal-lg">
  <div class="mh"><h3 id="fdTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„</h3><button class="mx" onclick="closeMo('fdModal')">âœ•</button></div>
  <div class="mb" id="fdBody"></div>
  <div class="mf">
    <button class="btn btn-ghost" onclick="closeMo('fdModal')">Ø¥ØºÙ„Ø§Ù‚</button>
    <button class="btn btn-warn" id="fdEdit">âœ ØªØ¹Ø¯ÙŠÙ„</button>
    <button class="btn btn-ok" id="fdResolve">âœ“ ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…Ø­Ù„ÙˆÙ„</button>
  </div>
</div>
</div>

<!-- Radar Modal -->

<div class="mo" id="radarModal">
<div class="modal">
  <div class="mh"><h3 id="radarModalTitle">ğŸ“¡ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¯Ø§Ø±</h3><button class="mx" onclick="closeMo('radarModal')">âœ•</button></div>
  <div class="mb">
    <div class="fr">
      <div class="fg"><label class="fl">ÙƒÙˆØ¯ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</label><input class="fi" id="rmCode" placeholder="RADAR-XX"></div>
      <div class="fg"><label class="fl">Ø§Ù„Ø­Ø§Ù„Ø©</label><select class="fs" id="rmStat"><option value="online">âœ… ÙŠØ¹Ù…Ù„</option><option value="fault">ğŸ”´ Ø¹Ø·Ù„</option><option value="maintenance">ğŸŸ¡ ØµÙŠØ§Ù†Ø©</option><option value="offline">âš« ØºÙŠØ± Ù…ØªØµÙ„</option></select></div>
    </div>
    <div class="fg"><label class="fl">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input class="fi" id="rmLoc" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠ â€“ Ø±Ø£Ø³ Ø§Ù„Ø¨Ø±"></div>
    <div class="fr">
      <div class="fg"><label class="fl">Ù†ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</label><input class="fi" id="rmType" placeholder="S-Band Surface Radar"></div>
      <div class="fg"><label class="fl">Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ØµÙ†Ø¹Ø©</label><input class="fi" id="rmMaker" placeholder="Furuno / Kelvin Hughes"></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">Ù†Ø·Ø§Ù‚ Ø§Ù„ÙƒØ´Ù (ÙƒÙ…)</label><input class="fi" id="rmRange" type="number" placeholder="96"></div>
      <div class="fg"><label class="fl">Ø¢Ø®Ø± ØµÙŠØ§Ù†Ø©</label><input class="fi" id="rmMaint" type="date"></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© (%)</label><input class="fi" id="rmReady" type="number" min="0" max="100" placeholder="95"></div>
      <div class="fg"><label class="fl">Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„</label><input class="fi" id="rmHours" type="number" placeholder="8760"></div>
    </div>
    <div class="fg"><label class="fl">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea class="ft" id="rmNotes" style="min-height:65px" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea></div>
  </div>
  <div class="mf"><button class="btn btn-ghost" onclick="closeMo('radarModal')">Ø¥Ù„ØºØ§Ø¡</button><button class="btn btn-accent" onclick="saveRadar()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±</button></div>
</div>
</div>

<!-- Member Modal -->

<div class="mo" id="memberModal">
<div class="modal">
  <div class="mh"><h3 id="memberModalTitle">ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ</h3><button class="mx" onclick="closeMo('memberModal')">âœ•</button></div>
  <div class="mb">
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input class="fi" id="mmName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ"></div>
      <div class="fg"><label class="fl">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label><input class="fi" id="mmUser" placeholder="username"></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input class="fi" id="mmEmail" type="email" placeholder="user@coastal.gov"></div>
      <div class="fg"><label class="fl">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input class="fi" id="mmPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</label><select class="fs" id="mmRole"><option value="admin">Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</option><option value="tech">ØªÙ‚Ù†ÙŠ ØµÙŠØ§Ù†Ø©</option><option value="viewer">Ù…Ø±Ø§Ù‚Ø¨</option></select></div>
      <div class="fg"><label class="fl">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label><input class="fi" id="mmPhone" placeholder="+966 5X XXX XXXX"></div>
    </div>
    <div class="fg"><label class="fl">Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³Ù†Ø¯Ø© (Ctrl + Click Ù„Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯)</label><select class="fs" id="mmRadars" multiple style="min-height:75px"></select></div>
    <div class="fg"><label class="fl">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea class="ft" id="mmNotes" style="min-height:60px" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù† Ø§Ù„Ø¹Ø¶Ùˆ..."></textarea></div>
  </div>
  <div class="mf"><button class="btn btn-ghost" onclick="closeMo('memberModal')">Ø¥Ù„ØºØ§Ø¡</button><button class="btn btn-accent" onclick="saveMember()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ø¶Ùˆ</button></div>
</div>
</div>

<!-- Profile Modal -->

<div class="mo" id="profileModal">
<div class="modal">
  <div class="mh"><h3>ğŸ‘¤ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h3><button class="mx" onclick="closeMo('profileModal')">âœ•</button></div>
  <div class="mb" id="profileBody"></div>
  <div class="mf"><button class="btn btn-ghost" onclick="closeMo('profileModal')">Ø¥ØºÙ„Ø§Ù‚</button><button class="btn btn-accent" onclick="saveProfile()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button></div>
</div>
</div>

<!-- â•â• RESET PASSWORD VIA PHONE â•â• -->

<div class="mo" id="resetPassModal">
<div class="modal" style="max-width:460px">
  <div class="mh"><h3>ğŸ”‘ Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3><button class="mx" onclick="closeMo('resetPassModal')">âœ•</button></div>
  <div class="mb">

```
<!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© -->
<div id="rstStep1">
  <div style="text-align:center;margin-bottom:20px">
    <div style="font-size:44px;margin-bottom:8px">ğŸ“±</div>
    <div style="font-size:15px;font-weight:900;color:#fff;margin-bottom:5px">Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¹Ø¨Ø± Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</div>
    <div style="font-size:12px;color:var(--td)">Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„</div>
  </div>
  <div class="fg"><label class="fl">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label><input class="fi" id="rstUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"></div>
  <div class="fg"><label class="fl">Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</label><input class="fi" id="rstPhone" type="tel" placeholder="+966 5X XXX XXXX"></div>
  <div id="rstErr1" style="display:none;padding:9px 13px;border-radius:5px;font-size:12px;margin-top:6px"></div>
</div>

<!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ OTP -->
<div id="rstStep2" style="display:none">
  <div style="text-align:center;margin-bottom:20px">
    <div style="font-size:44px;margin-bottom:8px">ğŸ’¬</div>
    <div style="font-size:15px;font-weight:900;color:#fff;margin-bottom:5px">Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</div>
    <div style="font-size:12px;color:var(--td)">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ù…Ø¤Ù‚Øª Ø¥Ù„Ù‰</div>
    <div id="rstPhoneTxt" style="font-family:'Share Tech Mono',monospace;color:var(--accent);font-size:14px;margin-top:4px"></div>
  </div>
  <div class="fg">
    <label class="fl">Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ (6 Ø£Ø±Ù‚Ø§Ù…)</label>
    <input class="fi" id="rstOtp" maxlength="6" placeholder="â— â— â— â— â— â—"
      style="text-align:center;font-family:'Share Tech Mono',monospace;font-size:22px;letter-spacing:8px"
      oninput="this.value=this.value.replace(/\D/g,'')">
  </div>
  <div style="text-align:center;font-size:11px;color:var(--td);margin-top:-8px">
    Ø§Ù„Ø±Ù…Ø² Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ: <span id="rstOtpShow" style="color:var(--accent);font-family:'Share Tech Mono',monospace;font-weight:bold"></span>
  </div>
  <div id="rstErr2" style="display:none;padding:9px 13px;border-radius:5px;font-size:12px;margin-top:10px"></div>
</div>

<!-- Ø§Ù„Ø®Ø·ÙˆØ© 3: ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
<div id="rstStep3" style="display:none">
  <div style="text-align:center;margin-bottom:20px">
    <div style="font-size:44px;margin-bottom:8px">ğŸ”</div>
    <div style="font-size:15px;font-weight:900;color:#fff;margin-bottom:5px">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>
    <div style="font-size:12px;color:var(--td)">Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©</div>
  </div>
  <div class="fg"><label class="fl">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
    <input class="fi" id="rstNewP" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
      oninput="passStrBar(this.value,'rstPSBar','rstPSLbl')">
  </div>
  <div style="height:5px;background:var(--s3);border-radius:3px;margin:-8px 0 6px;overflow:hidden">
    <div id="rstPSBar" style="height:100%;width:0;border-radius:3px;transition:all .3s"></div>
  </div>
  <div id="rstPSLbl" style="font-size:10px;color:var(--td);margin-bottom:12px"></div>
  <div class="fg"><label class="fl">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input class="fi" id="rstNewP2" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
  <div id="rstErr3" style="display:none;padding:9px 13px;border-radius:5px;font-size:12px"></div>
</div>
```

  </div>
  <div class="mf">
    <button id="rstBackBtn" class="btn btn-ghost" onclick="rstBack()" style="display:none">â†© Ø±Ø¬ÙˆØ¹</button>
    <button class="btn btn-ghost" onclick="closeMo('resetPassModal')">Ø¥Ù„ØºØ§Ø¡</button>
    <button id="rstNextBtn" class="btn btn-accent" onclick="rstNext()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø² â†</button>
  </div>
</div>
</div>

<!-- â•â• ADMIN RESET MEMBER PASSWORD â•â• -->

<div class="mo" id="adminResetModal">
<div class="modal" style="max-width:440px">
  <div class="mh"><h3>ğŸ”‘ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¹Ø¶Ùˆ</h3><button class="mx" onclick="closeMo('adminResetModal')">âœ•</button></div>
  <div class="mb">
    <div style="background:rgba(255,153,0,.07);border:1px solid rgba(255,153,0,.2);border-radius:6px;padding:11px 15px;margin-bottom:16px;font-size:13px;color:var(--warn)">
      âš  Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±: <strong id="arMemberName" style="color:#fff"></strong>
    </div>
    <div class="fg"><label class="fl">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
      <input class="fi" id="arNewP" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
        oninput="passStrBar(this.value,'arPSBar','arPSLbl')">
    </div>
    <div style="height:5px;background:var(--s3);border-radius:3px;margin:-8px 0 6px;overflow:hidden">
      <div id="arPSBar" style="height:100%;width:0;border-radius:3px;transition:all .3s"></div>
    </div>
    <div id="arPSLbl" style="font-size:10px;color:var(--td);margin-bottom:12px"></div>
    <div class="fg"><label class="fl">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input class="fi" id="arNewP2" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
    <div id="arMsg" style="display:none;padding:9px 13px;border-radius:5px;font-size:12px;margin-top:8px"></div>
  </div>
  <div class="mf">
    <button class="btn btn-ghost" onclick="closeMo('adminResetModal')">Ø¥Ù„ØºØ§Ø¡</button>
    <button class="btn btn-warn" onclick="doAdminReset()">ğŸ”‘ ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
  </div>
</div>
</div>

<!-- Confirm Modal -->

<div class="mo" id="confirmModal">
<div class="modal confirm-card">
  <div class="confirm-body">
    <div class="confirm-icon">âš ï¸</div>
    <div class="confirm-msg" id="confirmMsg">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ</div>
    <div class="confirm-sub">Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</div>
  </div>
  <div class="mf"><button class="btn btn-ghost" onclick="closeMo('confirmModal')">Ø¥Ù„ØºØ§Ø¡</button><button class="btn btn-danger" id="confirmOK">ØªØ£ÙƒÙŠØ¯</button></div>
</div>
</div>

<div class="toast" id="toast"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE & DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let currentUser = null;
let editFaultId = null;
let editRadarId = null;
let editMemberId = null;
let actLog = [];
let notifications = [];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECURITY â€” PASSWORD HASHING (SHA-256 simulation via stored hash)
   Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…Ø®Ø²Ù†Ø© ÙƒÙ€ hash Ù„Ø§ ÙƒÙ†Øµ ÙˆØ§Ø¶Ø­
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function sha256(msg) {
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(msg));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

/* Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† â€” ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø®Ø²Ù†Ø© ÙƒÙ€ SHA-256 hash */
const USERS = [
  {
    username:'alzubir',
    /* SHA-256 of "Alzubir6514@" */
    passwordHash:'b9fa148107a014d8ca3fa29f02a8fd1ee03937174569ed784410e8601c9c8620',
    role:'admin',
    name:'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø²Ø¨ÙŠØ±',
    email:'alzubir@coastal-radar.gov',
    phone:'',
    avatar:'Ø²'
  },
];

/* Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± */
async function verifyPassword(plain, storedHash) {
  /* Ù„Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©: Ù†Ù‚Ø§Ø±Ù† hash Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø§Ù„Ù€ hash Ø§Ù„Ù…Ø®Ø²Ù† */
  const inputHash = await sha256(plain);
  return inputHash === storedHash;
}

/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙØ§Ø´Ù„Ø© â€” Ø­Ù…Ø§ÙŠØ© Ù…Ù† Brute Force */
const loginAttempts = {};
const MAX_ATTEMPTS = 5;
const LOCKOUT_MS = 15 * 60 * 1000; /* 15 Ø¯Ù‚ÙŠÙ‚Ø© */

let radars = [
  {id:'RADAR-01',location:'Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠ',status:'online',type:'S-Band Surface Radar',maker:'Furuno',range:96,lastMaint:'',readiness:98,hours:0,faultsMonth:0,notes:''},
  {id:'RADAR-02',location:'Ø±Ø£Ø³ Ø§Ù„Ø¨Ø±',status:'online',type:'X-Band Coastal Radar',maker:'Kelvin Hughes',range:72,lastMaint:'',readiness:95,hours:0,faultsMonth:0,notes:''},
  {id:'RADAR-03',location:'Ø®Ù„ÙŠØ¬ Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø­Ù…Ø±',status:'online',type:'S-Band Surface Radar',maker:'Rutter',range:96,lastMaint:'',readiness:97,hours:0,faultsMonth:0,notes:''},
  {id:'RADAR-04',location:'Ø¬Ø²ÙŠØ±Ø© Ø§Ù„ØµÙŠØ§Ø¯',status:'online',type:'X-Band Coastal Radar',maker:'Furuno',range:64,lastMaint:'',readiness:95,hours:0,faultsMonth:0,notes:''},
  {id:'RADAR-05',location:'Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©',status:'online',type:'Dual-Band Radar',maker:'Terma',range:120,lastMaint:'',readiness:99,hours:0,faultsMonth:0,notes:''},
  {id:'RADAR-06',location:'Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©',status:'online',type:'S-Band Surface Radar',maker:'Raytheon',range:96,lastMaint:'',readiness:97,hours:0,faultsMonth:0,notes:''},
];

let members = [
  {id:'MBR-001',name:'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø²Ø¨ÙŠØ±',username:'alzubir',email:'alzubir@coastal-radar.gov',role:'admin',phone:'',radars:['RADAR-01','RADAR-02','RADAR-03','RADAR-04','RADAR-05','RADAR-06'],faultsClosed:0,lastLogin:'â€”',status:'active',notes:'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ'},
];

let faults = [];

notifications = [];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOGIN â€” SECURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function doLogin() {
  const u = document.getElementById('loginUser').value.trim().toLowerCase();
  const p = document.getElementById('loginPass').value;
  const err = document.getElementById('loginError');
  const btn = document.querySelector('.login-btn');

  /* ÙØ­Øµ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
  if(!u || !p) {
    showLoginError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
    shakeCard(); return;
  }

  /* ÙØ­Øµ Ø§Ù„Ù‚ÙÙ„ â€” Lockout */
  const now = Date.now();
  if(loginAttempts[u]) {
    const att = loginAttempts[u];
    if(att.locked && now - att.lockedAt < LOCKOUT_MS) {
      const rem = Math.ceil((LOCKOUT_MS - (now - att.lockedAt)) / 60000);
      showLoginError(`ğŸ”’ ØªÙ… ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø¤Ù‚ØªØ§Ù‹ â€” Ø­Ø§ÙˆÙ„ Ø¨Ø¹Ø¯ ${rem} Ø¯Ù‚ÙŠÙ‚Ø©`);
      shakeCard(); return;
    }
    if(att.locked && now - att.lockedAt >= LOCKOUT_MS) {
      loginAttempts[u] = {count:0, locked:false};
    }
  }

  /* ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© */
  btn.disabled = true;
  btn.textContent = 'Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚...';
  btn.style.opacity = '0.7';

  /* ØªØ£Ø®ÙŠØ± Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù…Ù†Ø¹ Timing Attacks */
  await new Promise(r => setTimeout(r, 600 + Math.random()*400));

  /* Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
  const userRecord = USERS.find(x => x.username === u);

  let authenticated = false;
  if(userRecord) {
    /* Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù€ hash â€” ÙÙŠ Ø¨ÙŠØ¦Ø© Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø³ÙŠÙƒÙˆÙ† bcrypt Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… */
    /* Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ø¤Ù…Ù‘Ù†Ø© Ù„Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© */
    authenticated = await checkCredentials(u, p, userRecord);
  }

  /* Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± */
  btn.disabled = false;
  btn.textContent = 'Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…';
  btn.style.opacity = '1';

  if(!authenticated) {
    /* ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙØ§Ø´Ù„Ø© */
    if(!loginAttempts[u]) loginAttempts[u] = {count:0, locked:false};
    loginAttempts[u].count++;
    const remaining = MAX_ATTEMPTS - loginAttempts[u].count;
    if(loginAttempts[u].count >= MAX_ATTEMPTS) {
      loginAttempts[u].locked = true;
      loginAttempts[u].lockedAt = Date.now();
      showLoginError(`ğŸ”’ ØªÙ… ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù„Ù…Ø¯Ø© 15 Ø¯Ù‚ÙŠÙ‚Ø© Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©`);
    } else {
      showLoginError(`âš  Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø© â€” ${remaining} Ù…Ø­Ø§ÙˆÙ„Ø© Ù…ØªØ¨Ù‚ÙŠØ©`);
    }
    shakeCard(); return;
  }

  /* Ù†Ø¬Ø­ Ø§Ù„Ø¯Ø®ÙˆÙ„ â€” Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª */
  if(loginAttempts[u]) loginAttempts[u] = {count:0, locked:false};
  err.classList.remove('show');
  currentUser = userRecord;
  members.find(m => m.username===u && (m.lastLogin=nowStr()));
  logAct('ğŸ”','ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…');
  startApp();
}

async function checkCredentials(u, p, userRecord) {
  /* Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¤Ù…Ù†Ø© â€” Constant-time compare Ù„Ù…Ù†Ø¹ Timing Attacks */
  const inputHash = await sha256(p);
  const storedHash = userRecord.passwordHash;
  /* Constant-time string comparison */
  if(inputHash.length !== storedHash.length) return false;
  let diff = 0;
  for(let i=0; i<inputHash.length; i++) diff |= inputHash.charCodeAt(i) ^ storedHash.charCodeAt(i);
  return diff === 0;
}

function showLoginError(msg) {
  const err = document.getElementById('loginError');
  err.textContent = msg;
  err.classList.add('show');
}

function shakeCard() {
  const card = document.querySelector('.login-card');
  card.style.animation = 'shake 0.4s ease';
  setTimeout(() => card.style.animation = '', 400);
}

document.getElementById('loginPass').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });

function startApp() {
  document.getElementById('loginPage').style.display='none';
  document.getElementById('appShell').classList.add('visible');
  // Set user info in topbar
  document.getElementById('topName').textContent = currentUser.name;
  const roleNames = {admin:'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…',tech:'ØªÙ‚Ù†ÙŠ ØµÙŠØ§Ù†Ø©',viewer:'Ù…Ø±Ø§Ù‚Ø¨'};
  document.getElementById('topRole').textContent = roleNames[currentUser.role];
  const avClass = {admin:'av-a',tech:'av-t',viewer:'av-v'};
  const av = document.getElementById('topAvatar');
  av.textContent = currentUser.avatar||currentUser.name[0];
  av.className = 'tu-avatar ' + avClass[currentUser.role];
  // Show/hide admin nav
  const isAdmin = currentUser.role === 'admin';
  ['adminNavS','nav-members','nav-settings','nav-actlog'].forEach(id=>{
    const el=document.getElementById(id);
    if(el) el.style.display=isAdmin?'':'none';
  });
  // Dashboard actions
  if(isAdmin) {
    document.getElementById('dashActions').innerHTML=`<button class="btn btn-accent" onclick="openFaultModal()">+ ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„</button>`;
    document.getElementById('radarActions').innerHTML=`<button class="btn btn-accent" onclick="openRadarModal()">+ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¯Ø§Ø±</button><button class="btn btn-ghost btn-sm" onclick="refreshRadarStatus()">â†» ØªØ­Ø¯ÙŠØ«</button>`;
  } else if(currentUser.role==='tech') {
    document.getElementById('dashActions').innerHTML=`<button class="btn btn-accent" onclick="openFaultModal()">+ ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„</button>`;
  }
  // Notifications
  renderNotifications();
  renderAll();
}

function logout() {
  logAct('ğŸšª','ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…');
  currentUser = null;
  document.getElementById('loginPage').style.display='flex';
  document.getElementById('appShell').classList.remove('visible');
  document.getElementById('loginUser').value='';
  document.getElementById('loginPass').value='';
  document.getElementById('userDropdown').classList.remove('open');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function goto(page, el) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.ni').forEach(n=>n.classList.remove('active'));
  const pg = document.getElementById('page-'+page);
  if(pg) pg.classList.add('active');
  const nav = document.getElementById('nav-'+page);
  if(nav) nav.classList.add('active');
  // Render
  if(page==='dashboard') renderDashboard();
  if(page==='radars') renderRadarPage();
  if(page==='readiness') renderReadiness();
  if(page==='faults') renderFaults();
  if(page==='members') renderMembers();
  if(page==='actlog') renderActLog();
  closeDrop();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER ALL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderAll() { renderDashboard(); renderFaults(); renderRadarPage(); renderReadiness(); updateTopStats(); renderNotifications(); }

function updateTopStats() {
  const crit = faults.filter(f=>f.severity==='critical'&&f.status==='open').length;
  const warn = faults.filter(f=>f.severity==='warning'&&f.status==='open').length;
  const res = faults.filter(f=>f.status==='resolved').length;
  document.getElementById('tsC').textContent=crit;
  document.getElementById('tsW').textContent=warn;
  document.getElementById('tsOK').textContent=res;
  document.getElementById('tsR').textContent=radars.length;
  const b = document.getElementById('navFaultBadge');
  const open=faults.filter(f=>f.status==='open').length;
  b.textContent=open;
  b.className='ni-badge '+(crit>0?'red':'yellow');
  if(open===0) b.className='ni-badge green';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderDashboard() {
  updateTopStats();
  const crit=faults.filter(f=>f.severity==='critical'&&f.status==='open').length;
  const warn=faults.filter(f=>f.severity==='warning'&&f.status==='open').length;
  const res=faults.filter(f=>f.status==='resolved').length;
  const online=radars.filter(r=>r.status==='online').length;
  const avgReady=Math.round(radars.reduce((a,r)=>a+r.readiness,0)/radars.length);
  
  document.getElementById('dashStats').innerHTML=`
    <div class="stat-card sc-red"><div class="sc-icon">ğŸ”´</div><div class="sc-val">${crit}</div><div class="sc-label">Ø£Ø¹Ø·Ø§Ù„ Ø­Ø±Ø¬Ø©</div><div class="sc-change">Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ø¢Ù†</div></div>
    <div class="stat-card sc-yellow"><div class="sc-icon">ğŸŸ¡</div><div class="sc-val">${warn}</div><div class="sc-label">Ø£Ø¹Ø·Ø§Ù„ ØªØ­Ø°ÙŠØ±ÙŠØ©</div><div class="sc-change">Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ø¢Ù†</div></div>
    <div class="stat-card sc-green"><div class="sc-icon">âœ…</div><div class="sc-val">${res}</div><div class="sc-label">Ø£Ø¹Ø·Ø§Ù„ Ù…Ø­Ù„ÙˆÙ„Ø©</div><div class="sc-change">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div></div>
    <div class="stat-card sc-blue"><div class="sc-icon">ğŸ“¡</div><div class="sc-val">${online}/${radars.length}</div><div class="sc-label">Ø±Ø§Ø¯Ø§Ø±Ø§Øª ØªØ¹Ù…Ù„</div><div class="sc-change">Ø¬Ø§Ù‡Ø²ÙŠØ©: ${avgReady}%</div></div>
  `;
  
  // Last faults
  document.getElementById('dashFaultsTable').innerHTML = faults.slice(0,5).map((f,i)=>`
    <tr style="animation-delay:${i*.05}s">
      <td class="td-mono">${f.id}</td>
      <td><span style="font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--accent)">${f.radar}</span></td>
      <td style="max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:#fff;font-size:13px">${f.title}</td>
      <td>${sevBadge(f.severity)}</td>
      <td>${statBadge(f.status)}</td>
    </tr>`).join('');
  
  // Radars table
  document.getElementById('dashRadarsTable').innerHTML = radars.map((r,i)=>`
    <tr style="animation-delay:${i*.05}s">
      <td><span style="font-family:'Share Tech Mono',monospace;font-size:12px;color:var(--accent)">${r.id}</span></td>
      <td style="font-size:12px;color:var(--td)">${r.location}</td>
      <td>${radarStatBadge(r.status)}</td>
      <td>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="prog-bar" style="flex:1;min-width:60px"><div class="prog-fill" style="width:${r.readiness}%;background:${r.readiness>=90?'var(--a2)':r.readiness>=70?'var(--warn)':'var(--danger)'}"></div></div>
          <span style="font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--td)">${r.readiness}%</span>
        </div>
      </td>
    </tr>`).join('');
  
  // Fault type chart
  const types = {};
  faults.forEach(f=>{types[f.type]=(types[f.type]||0)+1;});
  const max = Math.max(...Object.values(types),1);
  const colors=['var(--danger)','var(--warn)','var(--accent)','var(--a2)','var(--purple)','#888'];
  document.getElementById('faultTypeChart').innerHTML=Object.entries(types).map(([t,v],i)=>`
    <div class="mch-row">
      <div class="mch-label">${t}</div>
      <div class="mch-bar-wrap"><div class="mch-bar" style="width:${(v/max*100)}%;background:${colors[i%colors.length]}"></div></div>
      <div class="mch-val">${v}</div>
    </div>`).join('');
  
  // Activity
  renderDashActivity();
}

function renderDashActivity() {
  const el = document.getElementById('dashActivity');
  if(!actLog.length) { el.innerHTML=`<div class="empty"><div class="ei">ğŸ“‹</div><p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø¨Ø¹Ø¯</p></div>`; return; }
  el.innerHTML=[...actLog].reverse().slice(0,6).map((a,i)=>`
    <div class="activity-item" style="animation-delay:${i*.04}s">
      <div class="ai-icon">${a.icon}</div>
      <div><div class="ai-text"><span class="ai-user">${a.user}</span> ${a.text}</div><div class="ai-time">${a.time}</div></div>
    </div>`).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RADAR PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderRadarPage() {
  const search=document.getElementById('radarSearch')?.value.toLowerCase()||'';
  const statF=document.getElementById('radarStatFilter')?.value||'';
  let list=radars.filter(r=>{
    if(statF&&r.status!==statF)return false;
    if(search&&!r.id.toLowerCase().includes(search)&&!r.location.toLowerCase().includes(search))return false;
    return true;
  });
  
  const counts={online:radars.filter(r=>r.status==='online').length,fault:radars.filter(r=>r.status==='fault').length,maintenance:radars.filter(r=>r.status==='maintenance').length,offline:radars.filter(r=>r.status==='offline').length};
  document.getElementById('radarSummaryCards').innerHTML=`
    <div class="stat-card sc-green"><div class="sc-icon">âœ…</div><div class="sc-val">${counts.online}</div><div class="sc-label">Ø±Ø§Ø¯Ø§Ø±Ø§Øª ØªØ¹Ù…Ù„</div></div>
    <div class="stat-card sc-red"><div class="sc-icon">ğŸ”´</div><div class="sc-val">${counts.fault}</div><div class="sc-label">Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ù…Ø¹Ø·Ù„Ø©</div></div>
    <div class="stat-card sc-yellow"><div class="sc-icon">ğŸ”§</div><div class="sc-val">${counts.maintenance}</div><div class="sc-label">ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©</div></div>
    <div class="stat-card sc-blue"><div class="sc-icon">ğŸ“¡</div><div class="sc-val">${radars.length}</div><div class="sc-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</div></div>
  `;
  
  const isAdmin=currentUser?.role==='admin';
  const grid=document.getElementById('radarGrid');
  if(!list.length){grid.innerHTML=`<div class="empty" style="grid-column:1/-1"><div class="ei">ğŸ“¡</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø§Ø¯Ø§Ø±Ø§Øª</p></div>`;return;}
  grid.innerHTML=list.map((r,i)=>{
    const openF=faults.filter(f=>f.radar===r.id&&f.status==='open').length;
    const rColor=r.readiness>=90?'var(--a2)':r.readiness>=70?'var(--warn)':'var(--danger)';
    return `
    <div class="rc ${r.status}" style="animation-delay:${i*.06}s">
      <div class="rc-bar"></div>
      <div class="rc-body">
        <div class="rc-head">
          <div class="rc-id">${r.id}</div>
          <div class="status-pulse"><div class="sp-dot ${r.status}"></div></div>
        </div>
        <div class="rc-name">ğŸ“ ${r.location}</div>
        <div class="rc-stats">
          <div class="rcs"><div class="rcs-v">${r.range}</div><div class="rcs-l">Ù†Ø·Ø§Ù‚ (ÙƒÙ…)</div></div>
          <div class="rcs"><div class="rcs-v" style="color:${openF>0?'var(--danger)':'var(--a2)'}">${openF}</div><div class="rcs-l">Ø£Ø¹Ø·Ø§Ù„ Ù…ÙØªÙˆØ­Ø©</div></div>
          <div class="rcs"><div class="rcs-v" style="color:${rColor}">${r.readiness}%</div><div class="rcs-l">Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©</div></div>
        </div>
        <div class="rc-progress">
          <div class="rcp-label"><span>Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ØªØ´ØºÙŠÙ„</span><span>${r.readiness}%</span></div>
          <div class="rcp-bar"><div class="rcp-fill" style="width:${r.readiness}%;background:${rColor}"></div></div>
        </div>
        <div style="font-size:11px;color:var(--td);margin-bottom:10px;font-family:'Share Tech Mono',monospace;display:grid;grid-template-columns:1fr 1fr;gap:4px">
          <span>Ø§Ù„Ù†ÙˆØ¹: ${r.type}</span><span>Ø§Ù„Ù…ØµÙ†Ø¹: ${r.maker}</span>
          <span>Ø§Ù„Ø³Ø§Ø¹Ø§Øª: ${r.hours.toLocaleString()}</span><span>Ø¢Ø®Ø± ØµÙŠØ§Ù†Ø©: ${r.lastMaint||'â€”'}</span>
        </div>
        ${r.notes?`<div style="font-size:12px;color:var(--warn);background:rgba(255,153,0,.06);border:1px solid rgba(255,153,0,.15);border-radius:4px;padding:6px 10px;margin-bottom:10px">âš  ${r.notes}</div>`:''}
        <div class="rc-footer">
          ${radarStatBadge(r.status)}
          ${isAdmin?`<button class="btn btn-warn btn-sm" onclick="openRadarModal('${r.id}')">ØªØ¹Ø¯ÙŠÙ„</button>`:''}
          <button class="btn btn-ghost btn-sm" onclick="openFaultModal(null,'${r.id}')">+ Ø¹Ø·Ù„</button>
          ${isAdmin?`<button class="btn btn-danger btn-sm" onclick="confirmAction('Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¯Ø§Ø± ${r.id}ØŸ',()=>deleteRadar('${r.id}'))">Ø­Ø°Ù</button>`:''}
        </div>
      </div>
    </div>`}).join('');
}

function openRadarModal(id) {
  if(currentUser?.role!=='admin'){showToast('ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø£Ø¯Ù…Ù† Ù…Ø·Ù„ÙˆØ¨Ø©','danger');return;}
  editRadarId=id||null;
  const r=id?radars.find(x=>x.id===id):null;
  document.getElementById('radarModalTitle').textContent=r?`ğŸ“¡ ØªØ¹Ø¯ÙŠÙ„ ${r.id}`:'ğŸ“¡ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¯Ø§Ø± Ø¬Ø¯ÙŠØ¯';
  document.getElementById('rmCode').value=r?r.id:'';
  document.getElementById('rmLoc').value=r?r.location:'';
  document.getElementById('rmStat').value=r?r.status:'online';
  document.getElementById('rmType').value=r?r.type:'';
  document.getElementById('rmMaker').value=r?r.maker:'';
  document.getElementById('rmRange').value=r?r.range:'';
  document.getElementById('rmMaint').value=r?r.lastMaint:'';
  document.getElementById('rmReady').value=r?r.readiness:'';
  document.getElementById('rmHours').value=r?r.hours:'';
  document.getElementById('rmNotes').value=r?r.notes:'';
  openMo('radarModal');
}

function saveRadar() {
  const code=document.getElementById('rmCode').value.trim().toUpperCase().replace(/\s+/g,'-');
  if(!code){showToast('Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±','danger');return;}
  if(!editRadarId&&radars.find(r=>r.id===code)){showToast('Ø§Ù„ÙƒÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹','danger');return;}
  const data={id:code,location:document.getElementById('rmLoc').value,status:document.getElementById('rmStat').value,type:document.getElementById('rmType').value,maker:document.getElementById('rmMaker').value,range:+document.getElementById('rmRange').value||96,lastMaint:document.getElementById('rmMaint').value,readiness:+document.getElementById('rmReady').value||95,hours:+document.getElementById('rmHours').value||0,notes:document.getElementById('rmNotes').value};
  if(editRadarId){const i=radars.findIndex(r=>r.id===editRadarId);radars[i]=data;logAct('ğŸ“¡',`ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§Ø¯Ø§Ø± ${code}`);showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¯Ø§Ø±','ok');}
  else{radars.push(data);logAct('ğŸ“¡',`Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¯Ø§Ø± Ø¬Ø¯ÙŠØ¯: ${code}`);showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±','ok');}
  addNotif('ğŸ“¡',`ØªÙ… ${editRadarId?'ØªØ¹Ø¯ÙŠÙ„':'Ø¥Ø¶Ø§ÙØ©'} Ø§Ù„Ø±Ø§Ø¯Ø§Ø± ${code}`);
  closeMo('radarModal'); renderAll();
}

function deleteRadar(id) {
  radars=radars.filter(r=>r.id!==id);
  logAct('ğŸ—‘',`Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¯Ø§Ø± ${id}`);
  showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¯Ø§Ø±','danger');
  renderAll();
}

function changeRadarStatus(id,status) {
  const r=radars.find(x=>x.id===id);
  if(r){r.status=status;logAct('ğŸ“¡',`ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© ${id} Ø¥Ù„Ù‰ ${status}`);renderAll();}
}

function refreshRadarStatus() {
  showToast('âŸ³ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©...','warn');
  setTimeout(()=>{ renderRadarPage(); showToast('âœ“ ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«','ok'); }, 1200);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   READINESS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderReadiness() {
  const avgReady = Math.round(radars.reduce((a,r)=>a+r.readiness,0)/radars.length);
  const online = radars.filter(r=>r.status==='online').length;
  const totalHours = radars.reduce((a,r)=>a+r.hours,0);
  
  document.getElementById('readinessTopCards').innerHTML=`
    <div class="stat-card sc-${avgReady>=90?'green':avgReady>=70?'yellow':'red'}">
      <div class="sc-icon">ğŸ¯</div>
      <div class="sc-val">${avgReady}%</div>
      <div class="sc-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
      <div class="sc-change">${avgReady>=90?'Ù…Ù…ØªØ§Ø²':avgReady>=70?'Ø¬ÙŠØ¯':'ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†'}</div>
    </div>
    <div class="stat-card sc-blue">
      <div class="sc-icon">ğŸ“¡</div>
      <div class="sc-val">${online}/${radars.length}</div>
      <div class="sc-label">Ø±Ø§Ø¯Ø§Ø±Ø§Øª ØªØ¹Ù…Ù„ Ø§Ù„Ø¢Ù†</div>
      <div class="sc-change">${Math.round(online/radars.length*100)}% Ù…Ù† Ø§Ù„Ø·Ø§Ù‚Ø©</div>
    </div>
    <div class="stat-card sc-green">
      <div class="sc-icon">â±</div>
      <div class="sc-val">${Math.round(totalHours/1000)}K</div>
      <div class="sc-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„</div>
      <div class="sc-change">Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</div>
    </div>
  `;
  
  // Readiness rings
  document.getElementById('readinessGrid').innerHTML=radars.map((r,i)=>{
    const pct=r.readiness;
    const c=circumference(40);
    const off=c-(pct/100*c);
    const color=pct>=90?'#00ff9d':pct>=70?'#ff9900':'#ff3333';
    return `
    <div class="ready-card" style="animation-delay:${i*.07}s">
      <div class="ready-ring">
        <svg viewBox="0 0 90 90" width="90" height="90">
          <circle class="bg-circle" cx="45" cy="45" r="40" stroke="var(--s3)" stroke-width="6" fill="none"/>
          <circle class="fg-circle" cx="45" cy="45" r="40" stroke="${color}" stroke-width="6" fill="none" stroke-linecap="round" stroke-dasharray="${c}" stroke-dashoffset="${off}" transform="rotate(-90 45 45)"/>
        </svg>
        <div class="ready-pct" style="color:${color}">${pct}%</div>
      </div>
      <div class="ready-name">${r.id}</div>
      <div class="ready-loc">ğŸ“ ${r.location}</div>
      <div style="margin-top:8px">${radarStatBadge(r.status)}</div>
    </div>`;
  }).join('');
  
  // Monthly chart (simulated data)
  const months=['Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±','ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±'];
  const vals=[88,91,85,93,89,94,avgReady];
  document.getElementById('readinessMonthChart').innerHTML=months.map((m,i)=>{
    const v=vals[i];const color=v>=90?'var(--a2)':v>=70?'var(--warn)':'var(--danger)';
    return `<div class="mch-row"><div class="mch-label">${m}</div><div class="mch-bar-wrap"><div class="mch-bar" style="width:${v}%;background:${color}"></div></div><div class="mch-val">${v}%</div></div>`;
  }).join('');
  
  // Uptime
  document.getElementById('uptimeDisplay').textContent='12,847 Ø³Ø§Ø¹Ø©';
  document.getElementById('uptimeStats').innerHTML=`
    <div style="background:var(--s2);border-radius:5px;padding:10px;text-align:center"><div style="font-family:'Share Tech Mono',monospace;font-size:16px;color:var(--a2);font-weight:bold">99.2%</div><div style="font-size:11px;color:var(--td)">Ø¬Ø§Ù‡Ø²ÙŠØ© RADAR-05</div></div>
    <div style="background:var(--s2);border-radius:5px;padding:10px;text-align:center"><div style="font-family:'Share Tech Mono',monospace;font-size:16px;color:var(--danger);font-weight:bold">61%</div><div style="font-size:11px;color:var(--td)">Ø¬Ø§Ù‡Ø²ÙŠØ© RADAR-02</div></div>
  `;
  
  // Readiness table
  document.getElementById('readinessTable').innerHTML=radars.map((r,i)=>{
    const pct=r.readiness;const color=pct>=90?'var(--a2)':pct>=70?'var(--warn)':'var(--danger)';
    return `
    <tr style="animation-delay:${i*.05}s">
      <td><span style="font-family:'Share Tech Mono',monospace;font-size:12px;color:var(--accent)">${r.id}</span></td>
      <td style="font-size:12px;color:var(--td)">${r.location}</td>
      <td>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="prog-bar" style="width:80px"><div class="prog-fill" style="width:${pct}%;background:${color}"></div></div>
          <span style="font-family:'Share Tech Mono',monospace;font-size:12px;color:${color};font-weight:bold">${pct}%</span>
        </div>
      </td>
      <td class="td-mono">${r.hours.toLocaleString()}</td>
      <td class="td-mono" style="color:${r.faultsMonth>2?'var(--danger)':r.faultsMonth>0?'var(--warn)':'var(--a2)'}">${r.faultsMonth}</td>
      <td class="td-mono">${r.lastMaint||'â€”'}</td>
      <td>${radarStatBadge(r.status)}</td>
    </tr>`;
  }).join('');
}

function circumference(r){return 2*Math.PI*r;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FAULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderFaults() {
  populateSelects();
  const search=(document.getElementById('faultSearch')?.value||'').toLowerCase();
  const sev=document.getElementById('fSev')?.value||'';
  const stat=document.getElementById('fStat')?.value||'';
  const rad=document.getElementById('fRad')?.value||'';
  
  let list=faults.filter(f=>{
    if(sev&&f.severity!==sev)return false;
    if(stat&&f.status!==stat)return false;
    if(rad&&f.radar!==rad)return false;
    if(search&&!f.title.toLowerCase().includes(search)&&!f.id.toLowerCase().includes(search)&&!f.radar.toLowerCase().includes(search))return false;
    return true;
  });
  
  const crit=faults.filter(f=>f.severity==='critical'&&f.status==='open').length;
  const warn=faults.filter(f=>f.severity==='warning'&&f.status==='open').length;
  const open=faults.filter(f=>f.status==='open').length;
  const res=faults.filter(f=>f.status==='resolved').length;
  document.getElementById('faultStatsCards').innerHTML=`
    <div class="stat-card sc-red"><div class="sc-icon">ğŸ”´</div><div class="sc-val">${crit}</div><div class="sc-label">Ø­Ø±Ø¬Ø© Ù…ÙØªÙˆØ­Ø©</div></div>
    <div class="stat-card sc-yellow"><div class="sc-icon">ğŸŸ¡</div><div class="sc-val">${warn}</div><div class="sc-label">ØªØ­Ø°ÙŠØ±Ø§Øª Ù…ÙØªÙˆØ­Ø©</div></div>
    <div class="stat-card sc-blue"><div class="sc-icon">ğŸ“‚</div><div class="sc-val">${open}</div><div class="sc-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…ÙØªÙˆØ­Ø©</div></div>
    <div class="stat-card sc-green"><div class="sc-icon">âœ…</div><div class="sc-val">${res}</div><div class="sc-label">Ù…Ø­Ù„ÙˆÙ„Ø©</div></div>
  `;
  
  const canEdit=currentUser?.role!=='viewer';
  const isAdmin=currentUser?.role==='admin';
  const tbody=document.getElementById('faultsBody');
  if(!list.length){tbody.innerHTML=`<tr><td colspan="9"><div class="empty"><div class="ei">âš </div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¹Ø·Ø§Ù„</p></div></td></tr>`;return;}
  tbody.innerHTML=list.map((f,i)=>`
    <tr style="animation-delay:${i*.04}s">
      <td class="td-mono">${f.id}</td>
      <td><span style="font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--accent)">${f.radar}</span></td>
      <td style="max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:700;color:#fff">${f.title}</td>
      <td style="font-size:12px;color:var(--td)">${f.type}</td>
      <td>${sevBadge(f.severity)}</td>
      <td style="font-size:12px">${f.tech}</td>
      <td>${statBadge(f.status)}</td>
      <td class="td-mono">${f.date}</td>
      <td>
        <div style="display:flex;gap:4px;flex-wrap:wrap">
          <button class="btn btn-ghost btn-xs" onclick="showFaultDetail('${f.id}')">Ø¹Ø±Ø¶</button>
          ${canEdit?`<button class="btn btn-warn btn-xs" onclick="openFaultModal('${f.id}')">ØªØ¹Ø¯ÙŠÙ„</button>`:''}
          ${canEdit&&f.status==='open'?`<button class="btn btn-ok btn-xs" onclick="resolveFault('${f.id}')">Ø­Ù„Ù‘</button>`:''}
          ${isAdmin?`<button class="btn btn-danger btn-xs" onclick="confirmAction('Ø­Ø°Ù Ø§Ù„Ø¹Ø·Ù„ ${f.id}ØŸ',()=>deleteFault('${f.id}'))">Ø­Ø°Ù</button>`:''}
        </div>
      </td>
    </tr>`).join('');
}

function openFaultModal(id, preRadar) {
  const canEdit=currentUser?.role!=='viewer';
  if(!canEdit){showToast('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„','danger');return;}
  editFaultId=id||null;
  const f=id?faults.find(x=>x.id===id):null;
  document.getElementById('faultModalTitle').textContent=f?`âœ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„ ${f.id}`:'âš  ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯';
  populateSelects();
  document.getElementById('fmRad').value=f?f.radar:(preRadar||radars[0]?.id||'');
  document.getElementById('fmSev').value=f?f.severity:'critical';
  document.getElementById('fmTitle').value=f?f.title:'';
  document.getElementById('fmType').value=f?f.type:'Ø¹Ø·Ù„ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ';
  document.getElementById('fmTech').value=f?f.tech:(currentUser?.name||'');
  document.getElementById('fmDesc').value=f?f.desc:'';
  document.getElementById('fmAct').value=f?f.actions:'';
  document.getElementById('fmTags').value=f?(f.tags||[]).join('ØŒ '):'';
  document.getElementById('fmStat').value=f?f.status:'open';
  openMo('faultModal');
}

function saveFault() {
  const title=document.getElementById('fmTitle').value.trim();
  if(!title){showToast('Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ø·Ù„','danger');return;}
  const rad=document.getElementById('fmRad').value;
  const now=nowStr();
  if(editFaultId){
    const f=faults.find(x=>x.id===editFaultId);
    Object.assign(f,{radar:rad,severity:document.getElementById('fmSev').value,title,type:document.getElementById('fmType').value,tech:document.getElementById('fmTech').value,desc:document.getElementById('fmDesc').value,actions:document.getElementById('fmAct').value,tags:document.getElementById('fmTags').value.split(/[,ØŒ]/).map(t=>t.trim()).filter(Boolean),status:document.getElementById('fmStat').value});
    logAct('ğŸ“',`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„ ${editFaultId}`);
    showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø·Ù„','ok');
  } else {
    const nid='FLT-'+String(faults.length+1).padStart(3,'0');
    faults.unshift({id:nid,radar:rad,severity:document.getElementById('fmSev').value,title,type:document.getElementById('fmType').value,tech:document.getElementById('fmTech').value||'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',desc:document.getElementById('fmDesc').value,actions:document.getElementById('fmAct').value,date:now,status:document.getElementById('fmStat').value,tags:document.getElementById('fmTags').value.split(/[,ØŒ]/).map(t=>t.trim()).filter(Boolean),log:[`${now} â€“ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„ Ø¨ÙˆØ§Ø³Ø·Ø© ${currentUser?.name}`]});
    const r=radars.find(x=>x.id===rad);if(r)r.faultsMonth++;
    logAct('âš ',`ØªØ³Ø¬ÙŠÙ„ Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯: ${nid} â€“ ${title}`);
    addNotif('âš ',`Ø¹Ø·Ù„ Ø¬Ø¯ÙŠØ¯: ${title}`);
    showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„','ok');
  }
  closeMo('faultModal'); renderAll();
}

function resolveFault(id) {
  const f=faults.find(x=>x.id===id);
  if(!f)return;
  f.status='resolved';
  f.log.push(`${nowStr()} â€“ ØªÙ… Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ ÙƒÙ…Ø­Ù„ÙˆÙ„ Ø¨ÙˆØ§Ø³Ø·Ø© ${currentUser?.name}`);
  const m=members.find(x=>x.name===currentUser?.name||x.username===currentUser?.username);
  if(m)m.faultsClosed++;
  logAct('âœ…',`Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¹Ø·Ù„ ${id} ÙƒÙ…Ø­Ù„ÙˆÙ„`);
  addNotif('âœ…',`ØªÙ… Ø­Ù„ Ø§Ù„Ø¹Ø·Ù„ ${id}`);
  renderAll(); showToast('ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ø·Ù„ ÙƒÙ…Ø­Ù„ÙˆÙ„','ok');
}

function deleteFault(id) {
  faults=faults.filter(f=>f.id!==id);
  logAct('ğŸ—‘',`Ø­Ø°Ù Ø§Ù„Ø¹Ø·Ù„ ${id}`);
  renderAll(); showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø·Ù„','danger');
}

function showFaultDetail(id) {
  const f=faults.find(x=>x.id===id);if(!f)return;
  document.getElementById('fdTitle').textContent=`âš  ${f.id} â€“ ${f.title}`;
  const canEdit=currentUser?.role!=='viewer';
  document.getElementById('fdResolve').style.display=f.status==='open'&&canEdit?'inline-flex':'none';
  document.getElementById('fdEdit').style.display=canEdit?'inline-flex':'none';
  document.getElementById('fdEdit').onclick=()=>{closeMo('fdModal');openFaultModal(id);};
  document.getElementById('fdResolve').onclick=()=>{resolveFault(id);closeMo('fdModal');};
  document.getElementById('fdBody').innerHTML=`
    <div class="db">
      <div class="dkv"><div class="dk">Ø§Ù„Ø±Ø§Ø¯Ø§Ø±:</div><div class="dv" style="font-family:'Share Tech Mono',monospace;color:var(--accent)">${f.radar}</div></div>
      <div class="dkv"><div class="dk">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø·Ù„:</div><div class="dv">${f.type}</div></div>
      <div class="dkv"><div class="dk">Ø§Ù„ØªÙ‚Ù†ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:</div><div class="dv">${f.tech}</div></div>
      <div class="dkv"><div class="dk">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</div><div class="dv" style="font-family:'Share Tech Mono',monospace">${f.date}</div></div>
      <div class="dkv"><div class="dk">Ø§Ù„Ø®Ø·ÙˆØ±Ø©:</div><div class="dv">${sevBadge(f.severity)}</div></div>
      <div class="dkv"><div class="dk">Ø§Ù„Ø­Ø§Ù„Ø©:</div><div class="dv">${statBadge(f.status)}</div></div>
      <div class="dkv"><div class="dk">Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª:</div><div class="dv">${(f.tags||[]).map(t=>`<span style="background:rgba(13,51,82,.7);border:1px solid var(--border);padding:2px 8px;border-radius:12px;font-size:11px;margin-left:4px">${t}</span>`).join('')||'â€”'}</div></div>
    </div>
    <div class="sec-label">ÙˆØµÙ Ø§Ù„Ø¹Ø·Ù„</div>
    <div class="db" style="line-height:1.8;color:var(--text)">${f.desc||'â€”'}</div>
    <div class="sec-label">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ®Ø°Ø©</div>
    <div class="db" style="line-height:1.8;color:var(--text)">${f.actions||'â€”'}</div>
    <div class="sec-label">Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div>
    <div class="db">
      ${(f.log||[]).map(l=>`<div class="tl-item"><div class="tl-t">${l.split('â€“')[0]||''}</div><div class="tl-e">${l.split('â€“').slice(1).join('â€“').trim()}</div></div>`).join('')||'<div class="tl-e" style="color:var(--td)">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„</div>'}
    </div>
  `;
  openMo('fdModal');
}

function exportFaults() {
  const hdr='Ø§Ù„Ø±Ù‚Ù…,Ø§Ù„Ø±Ø§Ø¯Ø§Ø±,Ø§Ù„Ø¹Ù†ÙˆØ§Ù†,Ø§Ù„Ù†ÙˆØ¹,Ø§Ù„Ø®Ø·ÙˆØ±Ø©,Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„,Ø§Ù„Ø­Ø§Ù„Ø©,Ø§Ù„ØªØ§Ø±ÙŠØ®';
  const rows=faults.map(f=>`${f.id},${f.radar},"${f.title}",${f.type},${f.severity},${f.tech},${f.status},${f.date}`);
  const csv='\uFEFF'+hdr+'\n'+rows.join('\n');
  const a=document.createElement('a');a.href='data:text/csv;charset=utf-8,'+encodeURIComponent(csv);a.download='faults.csv';a.click();
  logAct('â¬‡','ØªØµØ¯ÙŠØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ CSV');
  showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù','ok');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MEMBERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderMembers() {
  const search=(document.getElementById('memberSearch')?.value||'').toLowerCase();
  const roleF=document.getElementById('memberRoleF')?.value||'';
  let list=members.filter(m=>{
    if(roleF&&m.role!==roleF)return false;
    if(search&&!m.name.toLowerCase().includes(search)&&!m.email.toLowerCase().includes(search))return false;
    return true;
  });
  const roleMap={admin:'Ù…Ø¯ÙŠØ±',tech:'ØªÙ‚Ù†ÙŠ',viewer:'Ù…Ø±Ø§Ù‚Ø¨'};
  const avCls={admin:'av-a',tech:'av-t',viewer:'av-v'};
  const bCls={admin:'b-admin',tech:'b-tech',viewer:'b-viewer'};
  const isAdmin=currentUser?.role==='admin';
  const tbody=document.getElementById('membersBody');
  if(!list.length){tbody.innerHTML=`<tr><td colspan="7"><div class="empty"><div class="ei">ğŸ‘¥</div><p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡</p></div></td></tr>`;return;}
  tbody.innerHTML=list.map((m,i)=>`
    <tr style="animation-delay:${i*.04}s">
      <td>
        <div class="member-cell">
          <div class="avatar ${avCls[m.role]}">${m.name[0]}${m.name.split(' ')[1]?.[0]||''}</div>
          <div><div class="mc-name">${m.name}</div><div class="mc-email">${m.email}</div></div>
        </div>
      </td>
      <td><span class="badge ${bCls[m.role]}">${roleMap[m.role]}</span></td>
      <td style="font-size:11px;color:var(--td)">${m.radars.length?m.radars.join(', '):'â€”'}</td>
      <td class="td-mono">${m.faultsClosed}</td>
      <td class="td-mono" style="font-size:11px">${m.lastLogin}</td>
      <td><span class="badge ${m.status==='active'?'b-online':'b-offline'}">${m.status==='active'?'Ù†Ø´Ø·':'Ù…Ø¹Ø·Ù„'}</span></td>
      <td>
        ${isAdmin?`
        <div style="display:flex;gap:4px;flex-wrap:wrap">
          <button class="btn btn-warn btn-xs" onclick="openMemberModal('${m.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
          <button class="btn btn-purple btn-xs" onclick="openAdminReset('${m.id}')">ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
          <button class="btn ${m.status==='active'?'btn-ghost':'btn-ok'} btn-xs" onclick="toggleMember('${m.id}')">${m.status==='active'?'ØªØ¹Ù„ÙŠÙ‚':'ØªÙØ¹ÙŠÙ„'}</button>
          <button class="btn btn-danger btn-xs" onclick="confirmAction('Ø­Ø°Ù ${m.name}ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹.',()=>deleteMember('${m.id}'))">Ø­Ø°Ù</button>
        </div>`:'â€”'}
      </td>
    </tr>`).join('');
}

function openMemberModal(id) {
  if(currentUser?.role!=='admin'){showToast('ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø£Ø¯Ù…Ù† Ù…Ø·Ù„ÙˆØ¨Ø©','danger');return;}
  editMemberId=id||null;
  const m=id?members.find(x=>x.id===id):null;
  document.getElementById('memberModalTitle').textContent=m?`ğŸ‘¤ ØªØ¹Ø¯ÙŠÙ„ ${m.name}`:'ğŸ‘¤ Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯';
  document.getElementById('mmName').value=m?m.name:'';
  document.getElementById('mmUser').value=m?m.username:'';
  document.getElementById('mmEmail').value=m?m.email:'';
  document.getElementById('mmPass').value='';
  document.getElementById('mmRole').value=m?m.role:'tech';
  document.getElementById('mmPhone').value=m?m.phone:'';
  document.getElementById('mmNotes').value=m?m.notes:'';
  const rs=document.getElementById('mmRadars');
  rs.innerHTML=radars.map(r=>`<option value="${r.id}" ${m&&m.radars.includes(r.id)?'selected':''}>${r.id} â€“ ${r.location}</option>`).join('');
  openMo('memberModal');
}

function saveMember() {
  const name=document.getElementById('mmName').value.trim();
  if(!name){showToast('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ','danger');return;}
  const email=document.getElementById('mmEmail').value.trim();
  const username=document.getElementById('mmUser').value.trim();
  const selR=Array.from(document.getElementById('mmRadars').selectedOptions).map(o=>o.value);
  if(editMemberId){
    const m=members.find(x=>x.id===editMemberId);
    Object.assign(m,{name,username,email,role:document.getElementById('mmRole').value,phone:document.getElementById('mmPhone').value,radars:selR,notes:document.getElementById('mmNotes').value});
    logAct('ğŸ‘¤',`ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ ${name}`);
    showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¶Ùˆ','ok');
  } else {
    const nid='MBR-'+String(members.length+1).padStart(3,'0');
    members.push({id:nid,name,username,email,role:document.getElementById('mmRole').value,phone:document.getElementById('mmPhone').value,radars:selR,faultsClosed:0,lastLogin:'â€”',status:'active',notes:document.getElementById('mmNotes').value});
    if(username&&document.getElementById('mmPass').value){
      sha256(document.getElementById('mmPass').value).then(h=>{
        USERS.push({username,passwordHash:h,role:document.getElementById('mmRole').value,name,email,avatar:name[0]});
      });
    }
    logAct('ğŸ‘¤',`Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯: ${name}`);
    showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¶Ùˆ','ok');
  }
  closeMo('memberModal'); renderMembers();
}

function toggleMember(id) {
  const m=members.find(x=>x.id===id);
  if(!m)return;
  m.status=m.status==='active'?'inactive':'active';
  logAct('ğŸ‘¤',`${m.status==='active'?'ØªÙØ¹ÙŠÙ„':'ØªØ¹Ù„ÙŠÙ‚'} Ø­Ø³Ø§Ø¨ ${m.name}`);
  renderMembers(); showToast(`ØªÙ… ${m.status==='active'?'ØªÙØ¹ÙŠÙ„':'ØªØ¹Ù„ÙŠÙ‚'} Ø§Ù„Ø¹Ø¶Ùˆ`);
}

function deleteMember(id) {
  const m=members.find(x=>x.id===id);
  members=members.filter(x=>x.id!==id);
  if(m)logAct('ğŸ—‘',`Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ ${m.name}`);
  renderMembers(); showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ø¶Ùˆ','danger');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACTIVITY LOG
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderActLog() {
  const tbody=document.getElementById('actLogBody');
  if(!actLog.length){tbody.innerHTML=`<tr><td colspan="4"><div class="empty"><div class="ei">ğŸ“‹</div><p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·</p></div></td></tr>`;return;}
  const roleNames={admin:'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…',tech:'ØªÙ‚Ù†ÙŠ ØµÙŠØ§Ù†Ø©',viewer:'Ù…Ø±Ø§Ù‚Ø¨'};
  tbody.innerHTML=[...actLog].reverse().map((a,i)=>`
    <tr style="animation-delay:${i*.02}s">
      <td class="td-mono">${a.time}</td>
      <td>${a.icon} ${a.text}</td>
      <td style="color:var(--accent);font-weight:700">${a.user}</td>
      <td><span class="badge b-${a.role}">${roleNames[a.role]||a.role}</span></td>
    </tr>`).join('');
}

function logAct(icon, text) {
  actLog.push({icon,text,user:currentUser?.name||'Ø§Ù„Ù†Ø¸Ø§Ù…',role:currentUser?.role||'admin',time:nowStr()});
  renderDashActivity();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NOTIFICATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderNotifications() {
  const unread=notifications.filter(n=>!n.read).length;
  document.getElementById('notifCount').textContent=unread;
  document.getElementById('notifCount').style.display=unread?'flex':'none';
  document.getElementById('notifList').innerHTML=notifications.slice(0,6).map(n=>`
    <div class="np-item ${n.read?'':'np-unread'}" onclick="markRead()">
      <div class="np-icon">${n.icon}</div>
      <div><div class="np-text">${n.text}</div><div class="np-time">${n.time}</div></div>
    </div>`).join('')||`<div class="np-item"><div class="np-text" style="color:var(--td);text-align:center;padding:10px">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</div></div>`;
}

function addNotif(icon, text) {
  notifications.unshift({icon,text,time:nowStr().split(' ')[1],read:false});
  renderNotifications();
}

function clearNotif() {
  notifications=[]; renderNotifications(); closeDrop(); showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª','ok');
}

function markRead() {
  notifications.forEach(n=>n.read=true); renderNotifications();
}

function toggleNotif() {
  const p=document.getElementById('notifPanel');
  const dd=document.getElementById('userDropdown');
  dd.classList.remove('open');
  p.classList.toggle('open');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROFILE MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openProfileModal() {
  const u=currentUser;if(!u)return;
  const avCls={admin:'av-a',tech:'av-t',viewer:'av-v'};
  const roleNames={admin:'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…',tech:'ØªÙ‚Ù†ÙŠ ØµÙŠØ§Ù†Ø©',viewer:'Ù…Ø±Ø§Ù‚Ø¨'};
  document.getElementById('profileBody').innerHTML=`
    <div style="text-align:center;margin-bottom:20px">
      <div class="avatar ${avCls[u.role]}" style="width:70px;height:70px;font-size:26px;margin:0 auto 12px;border-width:3px">${u.avatar||u.name[0]}</div>
      <div style="font-size:18px;font-weight:900;color:#fff">${u.name}</div>
      <div style="font-size:12px;color:var(--td);margin-top:3px">${u.email}</div>
    </div>
    <div class="db">
      <div class="dkv"><div class="dk">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</div><div class="dv" style="font-family:'Share Tech Mono',monospace">${u.username}</div></div>
      <div class="dkv"><div class="dk">Ø§Ù„Ø¯ÙˆØ±:</div><div class="dv">${roleNames[u.role]}</div></div>
      <div class="dkv"><div class="dk">Ø§Ù„Ù‡Ø§ØªÙ:</div><div class="dv">${u.phone||'â€”'}</div></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input class="fi" id="profName" value="${u.name}"></div>
      <div class="fg"><label class="fl">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label><input class="fi" id="profPhone" value="${u.phone||''}"></div>
    </div>
    <div class="fg"><label class="fl">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input class="fi" id="profEmail" value="${u.email}" type="email"></div>
    <div class="fr">
      <div class="fg"><label class="fl">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label><input class="fi" id="profPass" type="password" placeholder="Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„Ø¥Ø¨Ù‚Ø§Ø¡"></div>
      <div class="fg"><label class="fl">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label><input class="fi" id="profPass2" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
    </div>
  `;
  openMo('profileModal'); closeDrop();
}

function saveProfile() {
  const name=document.getElementById('profName').value.trim();
  const email=document.getElementById('profEmail').value.trim();
  const phone=document.getElementById('profPhone').value.trim();
  const pass=document.getElementById('profPass').value;
  const pass2=document.getElementById('profPass2').value;
  if(pass&&pass!==pass2){showToast('ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†','danger');return;}
  if(name){
    currentUser.name=name;
    document.getElementById('topName').textContent=name;
    const m=members.find(x=>x.username===currentUser.username);
    if(m){m.name=name;m.email=email;m.phone=phone;}
  }
  if(pass){
    sha256(pass).then(h=>{
      const u=USERS.find(x=>x.username===currentUser.username);
      if(u)u.passwordHash=h;
    });
  }
  logAct('ğŸ‘¤','ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ');
  closeMo('profileModal'); showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª','ok');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETTINGS â€” FULLY WORKING ENGINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const sysSet = {
  name:'Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ© â€“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©',
  email:'alerts@coastal-radar.gov',
  timezone:'AST+3', desc:'Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©',
  page_size:50, auto_logout:30,
  notif_critical:true, notif_any:true, notif_daily:false,
  notif_radar:true, notif_sound:false, notif_push:false,
  sec_2fa:false, sec_auto:true, sec_log:true, sec_lock:true,
  ui_grid:true, ui_ticker:true, ui_refresh:true, ui_anim:true, ui_pulse:true,
};

function doToggle(btn, key) {
  btn.classList.toggle('on');
  sysSet[key] = btn.classList.contains('on');
  updateNotifCount();
  flashSettingsBar(`${sysSet[key] ? 'âœ“ ØªÙ… ØªÙØ¹ÙŠÙ„' : 'â—‹ ØªÙ… ØªØ¹Ø·ÙŠÙ„'} Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯`);
}

function updateNotifCount() {
  const n = ['notif_critical','notif_any','notif_daily','notif_radar','notif_sound','notif_push']
    .filter(k=>sysSet[k]).length;
  const el = document.getElementById('activeNotifCount');
  if(el) el.textContent = n;
}

function flashSettingsBar(msg) {
  const bar = document.getElementById('settingsBar');
  const m = document.getElementById('settingsBarMsg');
  if(!bar||!m) return;
  m.textContent = msg;
  bar.style.display = 'flex';
  clearTimeout(bar._t);
  bar._t = setTimeout(()=>{ bar.style.display='none'; }, 3000);
}

function saveSettings() {
  const f = (id) => { const e=document.getElementById(id); return e?e.value:''; };
  sysSet.name = f('sName') || sysSet.name;
  sysSet.email = f('sEmail') || sysSet.email;
  sysSet.desc = f('sDesc') || sysSet.desc;
  sysSet.timezone = f('sTimezone') || sysSet.timezone;
  sysSet.page_size = +f('sPageSize') || 50;
  sysSet.auto_logout = +f('sAutoLogout') || 30;
  document.title = sysSet.name;
  logAct('âš™','Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…');
  flashSettingsBar('âœ“ ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
  showToast('âœ“ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª','ok');
}

function reqPush(btn) {
  if(!('Notification' in window)) { showToast('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª','danger'); btn.classList.remove('on'); sysSet.notif_push=false; return; }
  Notification.requestPermission().then(p=>{
    if(p==='granted') showToast('âœ“ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ Ù…ÙØ¹Ù‘Ù„Ø©','ok');
    else { btn.classList.remove('on'); sysSet.notif_push=false; showToast('ØªÙ… Ø±ÙØ¶ Ø¥Ø°Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª','warn'); }
  });
}

/* UI toggles that have real visual effects */
function applyGrid() {
  const el = document.querySelector('.grid-bg');
  if(el) el.style.opacity = sysSet.ui_grid ? '' : '0';
}
function applyTicker() {
  const el = document.querySelector('.ticker-wrap');
  if(el) el.style.visibility = sysSet.ui_ticker ? '' : 'hidden';
}
function applyAnims() {
  let s = document.getElementById('noAnimCSS');
  if(!sysSet.ui_anim) {
    if(!s) { s=document.createElement('style'); s.id='noAnimCSS'; document.head.appendChild(s); }
    s.textContent = '*{animation-duration:0.001s!important;transition-duration:0.001s!important}';
  } else { if(s) s.remove(); }
}

/* â”€â”€ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ø§Ù„ÙŠ â”€â”€ */
async function changeMyPassword() {
  const oldP = document.getElementById('sOldPass').value;
  const newP = document.getElementById('sNewPass').value;
  const newP2 = document.getElementById('sNewPass2').value;
  const msgEl = document.getElementById('myPassMsg');
  const showM = (txt,ok)=>{
    msgEl.textContent=txt; msgEl.style.display='block';
    msgEl.style.cssText+=`;background:${ok?'rgba(0,255,157,.08)':'rgba(255,51,51,.1)'};border:1px solid ${ok?'rgba(0,255,157,.25)':'rgba(255,51,51,.3)'};color:${ok?'var(--a2)':'var(--danger)'}`;
  };
  if(!oldP||!newP||!newP2){showM('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„',false);return;}
  if(newP!==newP2){showM('ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†',false);return;}
  if(newP.length<8){showM('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',false);return;}
  const uRec = USERS.find(x=>x.username===currentUser.username);
  if(!uRec){showM('Ø®Ø·Ø£ Ø¯Ø§Ø®Ù„ÙŠ',false);return;}
  const valid = await checkCredentials(currentUser.username, oldP, uRec);
  if(!valid){showM('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©',false);return;}
  uRec.passwordHash = await sha256(newP);
  ['sOldPass','sNewPass','sNewPass2'].forEach(id=>{const e=document.getElementById(id);if(e)e.value='';});
  document.getElementById('sPSFill_inner').style.width='0';
  document.getElementById('sPSLbl').textContent='';
  showM('âœ“ ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­',true);
  logAct('ğŸ”‘','ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø¯ÙŠØ± Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PASSWORD STRENGTH BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function passStrBar(pass, barId, lblId) {
  /* barId could be the fill div directly OR a wrapper with _inner child */
  let fill = document.getElementById(barId+'_inner') || document.getElementById(barId);
  let lbl  = document.getElementById(lblId);
  if(!fill||!lbl) return;
  let s=0;
  if(pass.length>=8)s++;
  if(pass.length>=12)s++;
  if(/[A-Z]/.test(pass))s++;
  if(/[0-9]/.test(pass))s++;
  if(/[^A-Za-z0-9]/.test(pass))s++;
  const lvl=[
    {w:'0',c:'transparent',t:''},
    {w:'20%',c:'#ff3333',t:'Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ø§Ù‹'},
    {w:'40%',c:'#ff7700',t:'Ø¶Ø¹ÙŠÙØ©'},
    {w:'60%',c:'#ffcc00',t:'Ù…ØªÙˆØ³Ø·Ø©'},
    {w:'80%',c:'#88dd00',t:'Ø¬ÙŠØ¯Ø©'},
    {w:'100%',c:'#00ff9d',t:'Ù‚ÙˆÙŠØ© Ø¬Ø¯Ø§Ù‹ âœ“'},
  ][Math.min(s,5)];
  fill.style.width=lvl.w; fill.style.background=lvl.c;
  lbl.textContent=lvl.t?`Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${lvl.t}`:''; lbl.style.color=lvl.c;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ADMIN FORCE-RESET MEMBER PASSWORD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let arTargetId = null;

function openAdminReset(memberId) {
  const m = members.find(x=>x.id===memberId);
  if(!m) return;
  arTargetId = memberId;
  document.getElementById('arMemberName').textContent = m.name;
  ['arNewP','arNewP2'].forEach(id=>{const e=document.getElementById(id);if(e)e.value='';});
  document.getElementById('arMsg').style.display='none';
  document.getElementById('arPSBar').style.width='0';
  document.getElementById('arPSLbl').textContent='';
  openMo('adminResetModal');
}

async function doAdminReset() {
  const newP = document.getElementById('arNewP').value;
  const newP2 = document.getElementById('arNewP2').value;
  const msgEl = document.getElementById('arMsg');
  const showM = (txt,ok)=>{
    msgEl.textContent=txt; msgEl.style.display='block';
    msgEl.style.cssText+=`;background:${ok?'rgba(0,255,157,.08)':'rgba(255,51,51,.1)'};border:1px solid ${ok?'rgba(0,255,157,.25)':'rgba(255,51,51,.3)'};color:${ok?'var(--a2)':'var(--danger)'}`;
  };
  if(!newP||!newP2){showM('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚Ù„ÙŠÙ†',false);return;}
  if(newP!==newP2){showM('ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†',false);return;}
  if(newP.length<8){showM('8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',false);return;}
  const m = members.find(x=>x.id===arTargetId);
  if(!m){showM('Ø®Ø·Ø£: Ø§Ù„Ø¹Ø¶Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯',false);return;}
  const h = await sha256(newP);
  let uRec = USERS.find(x=>x.username===m.username);
  if(uRec) uRec.passwordHash=h;
  else USERS.push({username:m.username,passwordHash:h,role:m.role,name:m.name,email:m.email,avatar:m.name[0]});
  logAct('ğŸ”‘',`Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¹Ø¶Ùˆ: ${m.name}`);
  showM(`âœ“ ØªÙ… ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù€ ${m.name}`,true);
  setTimeout(()=>closeMo('adminResetModal'),2000);
  showToast(`âœ“ ØªÙ… ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù€ ${m.name}`,'ok');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PASSWORD RESET VIA PHONE â€” 3 STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let rstStep=1, rstOtp=null, rstTarget=null;

function openResetModal() {
  rstStep=1; rstOtp=null; rstTarget=null;
  // Reset UI
  document.getElementById('rstStep1').style.display='';
  document.getElementById('rstStep2').style.display='none';
  document.getElementById('rstStep3').style.display='none';
  ['rstUser','rstPhone','rstOtp','rstNewP','rstNewP2'].forEach(id=>{const e=document.getElementById(id);if(e)e.value='';});
  ['rstErr1','rstErr2','rstErr3'].forEach(id=>{const e=document.getElementById(id);if(e)e.style.display='none';});
  document.getElementById('rstPSBar').style.width='0';
  document.getElementById('rstPSLbl').textContent='';
  document.getElementById('rstBackBtn').style.display='none';
  document.getElementById('rstNextBtn').textContent='Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø² â†';
  document.getElementById('rstNextBtn').style.display='';
  openMo('resetPassModal');
}

function rstShowErr(step, msg) {
  const e=document.getElementById(`rstErr${step}`);
  if(!e)return;
  e.textContent=msg; e.style.display='block';
  e.style.cssText+=';background:rgba(255,51,51,.1);border:1px solid rgba(255,51,51,.3);color:var(--danger)';
}
function rstShowOk(step, msg) {
  const e=document.getElementById(`rstErr${step}`);
  if(!e)return;
  e.textContent=msg; e.style.display='block';
  e.style.cssText+=';background:rgba(0,255,157,.08);border:1px solid rgba(0,255,157,.25);color:var(--a2)';
}

async function rstNext() {
  if(rstStep===1) {
    const uname = document.getElementById('rstUser').value.trim().toLowerCase();
    const phone = document.getElementById('rstPhone').value.trim().replace(/[\s\-]/g,'');
    if(!uname||!phone){rstShowErr(1,'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');return;}
    const m = members.find(x=>x.username===uname);
    if(!m){rstShowErr(1,'âš  Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…');return;}
    const mPhone = (m.phone||'').replace(/[\s\-]/g,'');
    if(!mPhone){rstShowErr(1,'âš  Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ Ù…Ø³Ø¬Ù‘Ù„ â€” ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ±');return;}
    // Ù‚Ø¨ÙˆÙ„ Ø£Ø´ÙƒØ§Ù„ Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ø±Ù‚Ù…
    const norm = (p)=>p.replace(/^00966|^\+966|^0/,'');
    if(norm(phone)!==norm(mPhone)){rstShowErr(1,'âš  Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ù„Ø§ ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨');return;}
    rstTarget = m;
    rstOtp = String(Math.floor(100000+Math.random()*900000));
    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© 2
    document.getElementById('rstStep1').style.display='none';
    document.getElementById('rstStep2').style.display='';
    document.getElementById('rstPhoneTxt').textContent = m.phone;
    document.getElementById('rstOtpShow').textContent = rstOtp;
    document.getElementById('rstBackBtn').style.display='inline-flex';
    document.getElementById('rstNextBtn').textContent='ØªØ­Ù‚Ù‚ â†';
    rstStep=2;

  } else if(rstStep===2) {
    const entered = document.getElementById('rstOtp').value.trim();
    if(!entered){rstShowErr(2,'Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚');return;}
    if(entered!==rstOtp){rstShowErr(2,'âš  Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­ â€” Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');return;}
    document.getElementById('rstStep2').style.display='none';
    document.getElementById('rstStep3').style.display='';
    document.getElementById('rstNextBtn').textContent='ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± âœ“';
    rstStep=3;

  } else if(rstStep===3) {
    const np = document.getElementById('rstNewP').value;
    const np2 = document.getElementById('rstNewP2').value;
    if(!np||!np2){rstShowErr(3,'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚Ù„ÙŠÙ†');return;}
    if(np!==np2){rstShowErr(3,'ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†');return;}
    if(np.length<8){rstShowErr(3,'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');return;}
    const h = await sha256(np);
    let uRec = USERS.find(x=>x.username===rstTarget.username);
    if(uRec) uRec.passwordHash=h;
    else USERS.push({username:rstTarget.username,passwordHash:h,role:rstTarget.role,name:rstTarget.name,email:rstTarget.email,avatar:rstTarget.name[0]});
    logAct('ğŸ”‘',`Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø³Ø§Ø¨: ${rstTarget.name} Ø¹Ø¨Ø± Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„`);
    rstShowOk(3,'âœ“ ØªÙ… ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.');
    document.getElementById('rstNextBtn').style.display='none';
    document.getElementById('rstBackBtn').style.display='none';
    setTimeout(()=>{closeMo('resetPassModal');showToast('âœ“ ØªÙ… ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©','ok');},2500);
  }
}

function rstBack() {
  if(rstStep===2){
    document.getElementById('rstStep2').style.display='none';
    document.getElementById('rstStep1').style.display='';
    document.getElementById('rstBackBtn').style.display='none';
    document.getElementById('rstNextBtn').textContent='Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø² â†';
    rstStep=1;
  } else if(rstStep===3){
    document.getElementById('rstStep3').style.display='none';
    document.getElementById('rstStep2').style.display='';
    document.getElementById('rstNextBtn').textContent='ØªØ­Ù‚Ù‚ â†';
    document.getElementById('rstNextBtn').style.display='';
    rstStep=2;
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function populateSelects() {
  // fmRad
  const fmRad=document.getElementById('fmRad');
  if(fmRad){const prev=fmRad.value;fmRad.innerHTML=radars.map(r=>`<option value="${r.id}">${r.id} â€“ ${r.location}</option>`).join('');if(prev)fmRad.value=prev;}
  // fmTech
  const fmTech=document.getElementById('fmTech');
  if(fmTech){const prev=fmTech.value;fmTech.innerHTML=members.filter(m=>m.role!=='viewer').map(m=>`<option>${m.name}</option>`).join('');if(prev)fmTech.value=prev;}
  // fRad
  const fRad=document.getElementById('fRad');
  if(fRad){const prev=fRad.value;fRad.innerHTML='<option value="">ÙƒÙ„ Ø§Ù„Ø±Ø§Ø¯Ø§Ø±Ø§Øª</option>'+radars.map(r=>`<option value="${r.id}">${r.id}</option>`).join('');if(prev)fRad.value=prev;}
}

function sevBadge(s){const m={critical:'b-crit Ø­Ø±Ø¬',warning:'b-warn ØªØ­Ø°ÙŠØ±',info:'b-info Ù…Ø¹Ù„ÙˆÙ…Ø§Øª'};const p=(m[s]||'b-info '+s).split(' ');return `<span class="badge ${p[0]}">${p.slice(1).join(' ')}</span>`;}
function statBadge(s){return s==='resolved'?'<span class="badge b-resolved">Ù…Ø­Ù„ÙˆÙ„</span>':'<span class="badge b-open">Ù…ÙØªÙˆØ­</span>';}
function radarStatBadge(s){const m={online:'b-online ÙŠØ¹Ù…Ù„',fault:'b-fault Ø¹Ø·Ù„',maintenance:'b-maint ØµÙŠØ§Ù†Ø©',offline:'b-offline ØºÙŠØ± Ù…ØªØµÙ„'};const p=(m[s]||'').split(' ');return `<span class="badge ${p[0]}">${p.slice(1).join(' ')||s}</span>`;}
function nowStr(){return new Date().toISOString().slice(0,16).replace('T',' ');}

function openMo(id){document.getElementById(id).classList.add('open');}
function closeMo(id){document.getElementById(id).classList.remove('open');}

function confirmAction(msg, cb) {
  document.getElementById('confirmMsg').textContent=msg;
  document.getElementById('confirmOK').onclick=()=>{closeMo('confirmModal');if(cb)cb();};
  openMo('confirmModal');
}

function showToast(msg, type) {
  const t=document.getElementById('toast');
  t.textContent=msg;t.className='toast '+(type||'');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),3000);
}

// Close dropdowns when clicking outside
document.addEventListener('click', e => {
  if(!e.target.closest('#userBtn'))document.getElementById('userDropdown').classList.remove('open');
  if(!e.target.closest('.notif-btn')&&!e.target.closest('#notifPanel'))document.getElementById('notifPanel').classList.remove('open');
  if(!e.target.closest('.mo')){}
});

function toggleUserMenu(){ document.getElementById('userDropdown').classList.toggle('open'); document.getElementById('notifPanel').classList.remove('open'); }
function closeDrop(){ document.getElementById('userDropdown').classList.remove('open'); }

// Close modals on overlay
document.querySelectorAll('.mo').forEach(o=>o.addEventListener('click',e=>{if(e.target===o)o.classList.remove('open');}));

// Clock
function tick(){document.getElementById('clock').textContent=new Date().toTimeString().slice(0,8);}
setInterval(tick,1000);tick();
</script>

</body>
</html>
